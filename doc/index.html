<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="description" content="Spirit: a study/biosample management software for drug discovery research">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

	<link rel="icon" href="../images/ico.png" type="images/png"/>
	<link rel="stylesheet" href="../css/bootstrap.min.css">
	<link rel="stylesheet" href="../css/jquery.fancybox.css?v=2.1.5" media="screen" />

    <link rel="stylesheet" href="../css/stylesheet.css">
	<script src="../js/jquery-3.1.0.min.js"></script>
	<script src="../js/jquery.fancybox.pack.js?v=2.1.5"></script>
	<script src="../js/bootstrap.min.js"></script>
	<script src="../js/main.js"></script>
    <title>Spirit Biobank - Documentation</title>

    <script src="https://code.jquery.com/jquery-3.4.1.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
  </head>

  <body data-spy="scroll" data-target="#navbar">
     <script>
 $(document).ready(function() {

    $.getJSON("https://api.ipify.org/?format=json", function(e) {
      if(e.ip.indexOf("212.203.114.")>=0) {
        window.location.replace("https://jfreyss.github.io/spirit/about/about.html");
      }
    });
  });
</script>	 
	  
    <div id="header_wrap" class="navbar navbar-default navbar-fixed-top">
      <header class="container">
		<nav>
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">Spirit</a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
			<li><a href="../concept/concept.html">Concept</a></li>
            <li><a href="../install/install.html">Download & Installation</a></li>
            <li class="active"><a href="../doc/index.html">Documentation</a></li>
            <li><a href="../about/about.html">About</a></li>
			<li><a id="forkme_banner" href="https://github.com/jfreyss/spirit">View on GitHub</a></li>
          </ul>
        </div>
        </nav>
      </header>
    </div>
	<div class="container">
		<div class="row">
			<div class="main col-md-9">

<h0 id="user">User guide</h0>
<p>
	<div class="alert alert-info">
		Note: You can press F1 at any time within the application, to be redirected to the appropriate section of this user guide
	</div>

	The Spirit interface is divided into five tabs:
	<ul>
		<li><b><a href="#home">Home</a>: </b>to view the latest changes
		<li><b><a href="#study">Study</a>: </b>to work on the study
		<li><b><a href="#biosample">Biosample</a>: </b>to view or search biological samples
		<li><b><a href="#location">Location</a>: </b>to manage the inventory
		<li><b><a href="#result">Results</a>: </b>to analyze results
	</ul>
</p>

<h1 id="home">Home</h1>
<p>
	<a class="fancybox pull-xs-right" href="home.png"><img src="home.png" title="Home Page"/></a>
	The <b>Home</b> tab is the first thing you see when starting Spirit. It shows the latest changes and allows the user to have a quick overview of the studies being worked on. For each study, it shows the data, that was generated and who did the latest modifications and when.  
	<ul>
		<li>Clicking on a study will redirect the user to the study visualization tab and open the clicked study.</li>
		<li>Clicking on a biotype will redirect the user to the biosample tab and display those biosamples</li>
		<li>Clicking on a test will redirect the user to the test tab and display the results of this test. The user can also click on "Analyze" to have a quick analysis of the results.</li>
	</ul>
</p>

<h1 id="study">Study</h1>
<p>
    The study tab shows the study centric view of Spirit. This is where the user can query studies and work on the design.
</p>

<h2 id="study_visualization">Visualization</h2>
<p>
    <a class="fancybox pull-xs-right" href="sc_study1.png"><img src="sc_study1.png" title="Study Page"/></a>
    On the study tab, you can query all the studies of the system, provided you have read access on the studies. By default and before making any search, Spirit will show you all the studies where your name is explicitely written in the list of users.
</p>
<p>
    To query for a study, you can either:
    <ul>
    <li>browse through the list of studies by clicking on the studyIds popup: several studies can be selected by keeping the button "Ctrl" pressed.
    <li>type some keywords in the "Study Search" field: Spirit will search all studies for the matching keywords in the title or in any of the other metadata. Complex queries such as "Example and (stratification or splitting)" are possible.
    </ul>
</p>

<h3 id="study_vis_design">Design</h3>
<p>
    The bottom left part shows the visual design of the study. The visualization may change a lot depending of the type of study. The following studies are given as examples in the system:
	
	<div class="row">
		<div class="col-xs-4">
			<b>Basic study:</b><br>
			<a class="fancybox" href="sc_study2.png"><img src="sc_study2.png"/></a>This is a basic study with 3 groups, lasting 7 phases. At day0, 5 animals are assigned to each group, and the treatment is given. From day1 to day6, a blood sampling is performed and at day 7, the animals are necropsied. The "w" signs shows that the animals have to be weighted every day.
		</div>
		<div class="col-xs-4">
			<b>Study wih subgroups:</b><br>
			<a class="fancybox" href="sc_study3.png"><img src="sc_study3.png"/></a>At day0, the animals are split into 2 groups (healthy, sick), but it is only at day2 that the animals are split again (Treated, NonTreated), based on some criteria like the weight.
		</div>
		<div class="col-xs-4">
			<b>Study wih subgroups</b><br>
			<a class="fancybox" href="sc_study4.png"><img src="sc_study4.png"/></a>When a lot of work has to be done, subgroups or stratification helps to split the work on several phases. Here, each group of 9 animals is split into 3 subgroups.  
		</div>
	</div>
		
</p>

<h3 id="study_vis_infos">Infos</h3>
<p>
    The bottom-right of the study tab shows the other infos of the study. There are 3 tabs there:
	<div class="row">
		<div class="col-xs-4">
			<b>Samples:</b><br>
			<a class="fancybox" href="sc_study5.png"><img src="sc_study5.png" title="Study Samples"/></a>This tab shows the list of biosamples attached to the study. The <strong>attached samples</strong> are the samples, that are follow the actions from the study design. If those samples have some children, it is possible to double-click to view all the samples, that have been collected.
		</div>
		<div class="col-xs-4">
			<b>Samplings:</b><br>
			<a class="fancybox" href="sc_study6.png"><img src="sc_study6.png" title="Study Samplings"/></a>This tab shows the <strong>sampling templates</strong> associated to the study. The sampling templates describes the samples the samples, that should be taken and how they should be taken. This example shows that the "blood sampling" consists of 2 aliquots of 5ml stored in Micronics, and that the "Necropsy" consists of the heart, the lung (left and right stored in one bottle), all of which have to be weighted ("w").
		</div>
		<div class="col-xs-4">
			<b>Infos</b><br>
			<a class="fancybox" href="sc_study7.png"><img src="sc_study7.png" title="Study Infos"/></a>This is the default tab, which shows the title, the infos, the workflow state, the user rights and all the data coming from this study. You can click on the "biosamples" link to be redirected to the biosample tab, or on the "results" link to be redirected to the result tab.
		</div>
    </div>
</p>
<h2 id="study_edit">Editing</h2>

<h3 id="study_infos">Infos</h3>
<p>
    <a class="fancybox pull-xs-right" href="sc_study8.png"><img src="sc_study8.png" title="Study Popup"/></a>
    To create/edit a new study, you can either go the menu or <strong>right-click on a study to open the contextual menu</strong>. Right-click works on almost everything in Spirit, and will make the appropriate popup menu open. If some options are grayed out, it means you don't have sufficient right, and you should contact one of the responsible person to add you on the list.
</p>
<p>
    <a class="fancybox pull-xs-right" href="sc_study9.png"><img src="sc_study9.png" title="Study Infos"/></a>
    On the study info dialog, it is possible to enter the fundamental information about the study:
    <dl>
    <dt>Parameters
    <dd>
        <ul>
            <li><b>StudyId: </b>is the unique Id, which is automatically generated by the system. Its format is: S-{00001}
            <li><b>InternalId: </b>is the non unique id, used in the organisation, such as an invivo, toxicology number, or the id from an external organisation
            <li><b>Title: </b>is the description of the study
            <li><b>Generate Samples automatically.: </b>this option is selected by default, it means that the samples are going to automatically generated as described in the study design.<br>
            There are however cases, where the automatic generation and deletion of samples will lead to unwanted effects (studies entered a posteriori, or studies where each patient will get completely different samples). In those cases, it is better to uncheck it, and let the user create the samples manually.
        </ul>
    <dt>Metadata
    <dd><strong>Study metadata</strong> are configurable, so the list of metadata may depends of the Spirit configuration you have. All those fields are searchable and displayed in the study table.
    <dt>State
    <dd>The <strong>worklow states</strong> are also configurable by a system administrator. The attached table shows the configured states and the configured rights for each of those states: "ALL" means everybody has the rights, otherwise the rights are restricted to the given role and users.
    <dt>User Rights
    <dd>The <strong>user rights</strong> are shown only if a user database is configured (when Spirit is run in a server mode). There you can enter the usernames of the user who have: 
        <ul>
            <li><b>Admin rights: </b> can change the infos/the design of the study and attach samples.
            <li><b>Experimenter rights: </b> can add samples or results to the study.
            <li><b>Blind-Details: </b> limited rights on the study, but enough to view the design. The groups are shown, but without the groupNames (only the short abbrevation is shown) and without the compound (only the treatment's abbreviation is shown). This is the recommended role for technicians, who have to apply treatments.
            <li><b>Blind-All: </b> limited rights on the study. All informations about the groups and the treatments are hidden, including the colors and the abbreviation. It is not even possible to see if two samples come from the same group. This is the recommended roles for technicians, who have to make the observations or other measurements.
        </ul>
    <dt>Notes: 
    <dd>Anything goes here.
    </dl>
</p>

<h3 id="study_design">Design</h3>
<p>
    <a class="fancybox pull-xs-right" href="sc_study10.png"><img src="sc_study10.png" title="Study Design"/></a>
    Go to the study design by right-clicking on the study and selecting "Edit->Study Design".
</p>

<h4>1. Infos</h4>
<p>
Please look at the section <a href="#study_infos">above</a> to have an explanation of this
</p>

<h4>2. Documents</h4>
<p>
    You can attach as many documents as you want in the study. Documents are categorized in "Consent Form", "Design", "Presentation", "Other" and are for documentation purpose.
    The <strong>consent form</strong> is a special type of document. By adding a document, all samples from the study are highlighted in red, with a link to the consent form.
</p>

<h4 id="study_phase">3. Phases</h3>
<p>
    The phases define the timeline of the study. Phases can be formatted as: 
    <dl>
    <dt>d0, d1, d3:
    <dd><p>Use the "day, hour, second" format if the event happen at a precise time. Negative days (d-1) are used for the pre-study observation. d0 is normally used for the group assignment or first treatment.</p>
    <p>It is possible to enter hours, minutes and a label by using this format: "d0_6h30 instillation"</p>  
    <p>It is possible to enter a starting date to have absolute dates for the phases. By using absolute dates, Spirit can indicate when each action should take place (treatments, samplings, measurements).</p>
    <dt>1. Baseline, 2., 3. EOT: 
    <dd>Use this format when actions don't take place at exact dates, but at some point of time. The phases become markers for the baseline, end of treatment, first visit, ... 
    </dl>
</p>
<p>
    <a class="fancybox pull-xs-right" href="sc_study11.png"><img src="sc_study11.png" title="Study Design - Phases"/></a>
	To add phases, right click on the table and select "add rows". You can also use the up/down keyboard to add phases at the bottom/top of the table.<br>
	To remove phases, right click on the table and select "delete rows". You can also click delete on the keyboard to remove the selected phase. Make sure you have no samples or results attached to that phase.<br>
	To rename, simply select the phase and type the new name.<br>
	

</p>

<h4 id="study_group">4. Groups</h4>
<p>
    <a class="fancybox pull-xs-right" href="sc_study12.png"><img src="sc_study12.png" title="Study Design - Groups"/></a>
    When similar actions (same treatment, same sampling, same measurements) take place on several biosamples, those biosampes should be put together in a group. 
</p>
<p>
    Each group needs to be defined with the following attributes:
    <dl>
    <dt>Group Definition
    <dd>
        <ul>
        <li><b>Abbreviation: </b> a short and unique id such as  1, 2, 3 or 1A, 1B. This is the identifier shown to the blind experimenter or displayed next to the sampleId throughout the application.
        <li><b>Name: </b> is the description of the group such as: Control, Sham, ...
        <li><b>Color: </b> is the background color used for the group and for the cage labels
        </ul>
    </dd>
    <dt>Group Assignment
    <dd>When and how the specimen are assigned to this group? This feature is only useful if the experimenter wants to use the automatic group assignment, or for visualization purpose.
        <ul>
        <li><b>Normal group assignment:</b> the phase indicates when samples are attached to this group; the phase is optional if it is undefined. For studies where a group of animals (ex: sick) is splitted into 2 new groups (ex: treated and non-treated), you can indicate from which group this group originates.  
        <li><b>The initial samples are divided into subsamples:</b> this is a special scenario to indicate that the attached samples will be divided into other samples, that will be treated/analyzed over time. Example: a study of animals, where patches of skin are treated with different treatments.
        </ul>
    <dt>Group Size:
    <dd>This indicate the number of subgroups and the number of samples expected to be attached to each of them. The subgroups are used for samples, that should be compared together, but where each subgroup show some changes in the actions. Example: stratification.
    </dl>
</p>
<h4 id="study_treatment">5. Treatments</h4>
<p>
    <a class="fancybox pull-xs-right" href="sc_study13.png"><img src="sc_study13.png" title="Study Design - Treatments"/></a>
    Treatment are identified by:
    <ul>
    <li><b>Name: </b> short and selft explanatory name to describe the treatment. 
    <li><b>Color: </b> this is how the treatment will be shown in the design and to the experimenter. 
    <li><b>Compound 1, Conpound 2: </b>are the reference identifiers of the compounds. This info is hidden from users with blind-details rights.
    <li><b>Amount / Unit / Administration: </b> If an amount and a unit, Spirit calculates the amount to be given based on the weight.
    </ul>
</p>

<h4 id="study_sampling">6. Sampling Templates</h4>
<p>
    <a class="fancybox pull-xs-right" href="sc_study14.png"><img src="sc_study14.png" title="Study Design - Sampling Template"/></a>
    The sampling templates describes the samples to be taken. When you click the button "Add Sampling", you can either decide to start from an empty template or to import a template from a previous study and modify it.
</p>
<p>
    You should name the template with a self-explanatory name, and specify if it is a necropsy sampling. After a necropsy, the animal's status becomes unavailable.
</p>
<p>
    <a class="fancybox pull-xs-right" href="sc_study15.png"><img src="sc_study15.png" title="Study Design - Sampling"/></a>In each template, you may define any number of samples. To add a new sample, you can either click on "Add Sample" or click on the button next to each sample, and select "duplicate". For each sample, you must specify:
    <ul>
    <li>the <b>biotype</b>
    <li>the <b>metadata, amount, comments </b> The metadata depends of the selected biotype.
    <li><b>Container: </b> If the sample to be generated has to be kept, you must specify the type of container (matrix, fluidx, eppendorf, ...). If the container can contain several samples (bottle, bags, cassette, slides), you must specify the container's number. For example, the lung and the heart can be stored in the same bottle (#1) or in 2 separate bottles (#1 and #2).
    <li><b>Measurements: </b> When the sample is collected, it is possible to perform some measurements, such as measuring the weight, the length, some observations, or any other other measurement on one of the defined test. This list of measurements is used in the "sample measurement" dialog.
    </ul>
</p>

<h4>7. Actions</h4>
<p>
    <a class="fancybox pull-xs-right" href="sc_study16.png"><img src="sc_study16.png" title="Study Design - Actions"/></a>
    Once the treatments, sampling templates are defined, the user can specify on which groups and when those actions have to be performed.
</p>
<p>
    To add an action, select one of the option at the top, and then click on the study design at the intersection of a group and a phase to indicate the action to be taken.
    <ul>
    <li><b>Add measurement:</b> Weighing, Food, Water or on any other predefined test. Those measurements are done on the attached samples during the "live monitoring" and results are retrievable for analysis.
    <li><b>Add treatment: </b>select one of the treatments defined before and the group/phase to perform it. The treatment is displayed above the timeline.
    <li><b>Add sampling: </b>select one of the sampling's template defined before and the group/phase where the sampling has to be done. The sampling's template is displayed below the timeline in red. If the template is marked as "Necropsy", a cross shows the end of the timeline.
    <li><b>Add label:</b>you can type some text and have it displayed on the study. Labels are purely informative.
    </ul>
    You can also drag the mouse to add several actions at once.
</p>

<h3>Group Assignment</h3>
<p>
    <a class="fancybox pull-xs-right" href="sc_study17.png"><img src="sc_study17.png" title="Study Design - Actions"/></a>
    To attach biosamples to the study, right-click on the study, and select "Edit->Automatic Assignment" or "Edit->Manual Assignment".
    <ul>
    <li><b>Automatic Assignment: </b> The automatic assignment guides the user through a wizard to randomize the assignment based on some criteria like the weight or on some other data. This option is only valid on the phases, where groups are set to be assigned as defined in the <a href="#editGroups">group</a> section. 
    <li><b>Manual Assigment: </b>This option can be used anytime.
    </ul>
</p>
<p>
    Samples can only be attached to one study and to one group. To reuse the same sample across 2 studies or groups, the trick is to clone the samples. Example: to use ANL0001 in 2 studies, it is cloned to ANL0001A and ANL0001B (both inheriting from ANL00001). This process is automatically performed by Spirit.
    <a class="fancybox pull-xs-right" href="cloning.png"><img src="cloning.png" title="Cloning"/></a>
</p>

<h4 id="study_auto">Automatic Assignment</h4>
<p>
    The <strong>automatic assigment wizard</strong> guide you through the steps of attaching the samples to the groups.<br>
</p>

<h5>1. Parameters</h5>
<p>
    <a class="fancybox pull-xs-right" href="sc_study18.png"><img src="sc_study18.png" title="Automatic Assignment - Parameters"/></a>
    The first part of the wizard gives overview of the groups to be assigned. You can enter the biotype of the samples to be randomized.
</p>

<h5>2. Randomization Data</h5>
<p>
    <a class="fancybox pull-xs-right" href="sc_study19.png"><img src="sc_study19.png" title="Automatic Assignment - Randomization data"/></a>
    The second part of the wizard is where you enter the randomization data.
    <ul>
    <li><b>Number of attached samples: </b>By default, this number shows the number of samples to be randomized. You can increase this number to start with more samples. Extra samples will not be assigned to a group (reserve).
    <li><b>Number of other data: </b>By default, the randomization is done on the weight only, but you can randomize over other criteria (blood pressure, ...).
    <li><b>Synchronize from current situation: </b>Expert feature. This tab shows the historic data, which was saved the last time you came to this dialog. If the samples were later modified, you may want to synchronize the historic data with the data currently in the database. This button is only enabled if there are samples already attached to the study.
    <li><b>Use Balance:</b> You can configure a Mettler-Toledo to weight the samples on the fly. See Annex / Balance Configuration to see how to configure an external balance. The balance configured, this option is enabled by default, and the weight is entered automatically.
    </ul>
</p>
<h5>3. Group Assignment</h5>
<p>
    <a class="fancybox pull-xs-right" href="sc_study20.png"><img src="sc_study20.png" title="Automatic Assignment - Group Assignment"/></a>
    The third part of the wizard is where the user makes the group assignment. 
    <ul>
    <li><b>Put Lightest / Heaviest to Reserve: </b> If you have more samples than needed, checking those boxes will put the extrema (compared to the average) in the reserve. Uncheck them if you want to consider all specimen in the randomization
    <li><b>Automatic Randomization:</b> Click to let Spirit do the randomization. It is possible to have a different result everytime this button is clicked due to the random permutations used in the algorithm.
    </ul>
</p>
<p>
    Spirit uses a simulated annealing algorithm to tests thousands of permutations until each group share similar characteristics (mean, standard deviation). The optimal randomization is the randomization, minimizing the following formula:
    <br>
    <a class="fancybox pull-xs-right" href="formula.png"><img src="formula.png" title="Automatic Assignment - Group Assignment formula"/></a>
</p>
<p>
    The group assignment can be done manually partly of fully, by dragging the sample from group to groups. You can also right-click on the sample and select <strong>"Fix group"</strong>, so that the randomization keeps those samples untouched.
</p>

<h5>4. Cage Assignment</h5>
<p>
    <a class="fancybox pull-xs-right" href="sc_study21.png"><img src="sc_study21.png" title="Automatic Assignment - Cage Assignment"/></a>
    To set cages automatically, click on the maximum number of samples per cages. Spirit will still try to average the number of animals per cages. If you have 12 animals and select a max of 5, Spirit will assign 4 animals in each cage instead of 5,5 and 2.
</p>
<p>
    The checkbox "Reuse previous CageId" is enabled if you have group splitting. In that case, you can decide if you want to reuse the same cages, or reuse new ones.
</p>

<h5>5. Saving</h5>
<p>
    <a class="fancybox pull-xs-right" href="sc_study22.png"><img src="sc_study22.png" title="Automatic Assignment - Saving"/></a>
    The last step of the wizard is where you review the group assignment, update the subgroups, renumber, enter the metadata, comments. If everything is fine, click the "Make the assignments" button to update the database to match this randomization. The "automatic renumbering" button is used to renumber the samples sequentially as displayed in this table.
</p>

<h4 id="study_manual">Manual Assigment</h4>
<p>
    <a class="fancybox pull-xs-right" href="sc_study23.png"><img src="sc_study23.png" title="Manual Assigment"/></a>
    In this dialog, you can directly type or copy/paste the samples with their group assignment. At any time, you can open the dialog to change the groups/subgroups, attach a new sample, or detach a sample from the study. 
</p>

<h2>Monitoring</h2>
<h3>Live Monitoring</h3>
<p>
    <a class="fancybox pull-xs-right" href="sc_study24.png"><img src="sc_study24.png" title="Live Monitoring popup"/></a>
    Right-click on a study and select "Live Monitoring", to monitor the actions to be done on each attached sample of the study.
</p>

<h4 id="study_overview">Overview</h4>
<p>
    <a class="fancybox pull-xs-right" href="sc_study25.png"><img src="sc_study25.png" title="Live Monitoring overview"/></a>
    The left pane of the overview dialog shows all the actions to be performed on the attached samples: group assignment, weighing, treatments as defined in the <a href="#studydesign">study design</a>.
</p> 
<p>
    For each phase, there is a summary of what has been done and what needs to be done. A green flag means all the actions have been done. Click on the "group assignment" to go to the <a href="#automaticassignment">"automatic assignment"</a> dialog, click on the phase button to go to the "Live Monitoring" dialog. Even if there are no programmed action for the measured day, you can click on the phase button and enter some measurements.
</p>
<p>
    If a starting date has been entered for the study, the date is shown and the current day is highlighted.
</p>
<p>
    On the right side of the dialog, the tables show the historic results:
    <ul>
    <li><b>Results: Weighings: </b>shows the weighing results with the percentage increase since d0 (or the closest of d0 if there is no d0).
    <li><b>Results: Observations: </b>shows the observations.
    <li><b>Results: Food and Water: </b>shows the food and water intake with the percentage increase since d0. Since we cannot distinguish the food and water by animals but only per cage, the results are the same for all animal in the same cage.
    <li><b>Manip: Treatment: </b>To view all given treatments .
    </ul>
    It is also possible to configure the display and export the data to DataWarrior, Excel or as CSV, as explained in the "Working with Results" paragraph.
</p>
<h4 id="study_monitoring">Live Measurements</h4>
<p>
    <a class="fancybox pull-xs-right" href="sc_study26.png"><img src="sc_study26.png" title="Live Monitoring measurement"/></a>
    After clicking a phase, the Live Monitoring dialogs shows up. Spirit shows the required measurements specified in the study design, by default.
</p>
<p>
    There are no "Save" button in this dialog because the data is saved just after being entered, with the exact time. By saving the data on the fly, Spirit avoids any possible errors due to network errors or human errors (such as closing the dialog without saving).
<p>
</p>
    All yellow fields are required and automatically get the focus of the user. After entering each value, a popup dialog will show up to inform the experimenter about the treatment to be given, together with the calculated dose. For documentation purpose, the experimenter can also enter the formulation.
    Next to each value, Spirit displays the last measured value, and the percentage increase.
<p>
<p>
    By hovering the mouse cursor over a field, it is possible to view when the experimenter entered the last value. To enter a new value, click on the field and confirm you want to enter a new value.
</p>
<p>    
    If the user is among the <b>blind-details</b> users, he will not be able to visualize the group description and the compounds, but only the group abbreviation and the treatment's name.<br>
    If the user is among the <b>blind-all</b> users, he will not be able to visualize anything related to the group or the treatment. The users that are fully blinded cannot see if the specimen belongs to a group or not, nor if the specimen have to be treated ot not.
</p>



<h3 id="study_living">Replace / Set Living Status</h3>
<p>
    <a class="fancybox pull-xs-right" href="sc_study31.png"><img src="sc_study31.png" title="Replace / Set Living Status"/></a>
    The "Replace / Set Living Status" is a convenient dialog to set the status of an attached biosample and/or to replace it by an other sample from the reserve.
    <dl>
    <dd>
        <ul>
        <li><b>Move To Reserve: </b> this function will remove the group assignment at the given phase.
        <li><b>Change Status to Alive: </b> You can use this function, to cancel a previous change of status.
        <li><b>Change Status to Necropsied: </b> This will update the date of death, and mark the animal as necropsied. This step is not required when the planned date of death is already in the study design (ie. when there is sampling template marked as necropsy)
        <li><b>Change Status to Found Dead: </b> You can use this function, to mark the animal as Found Dead. All samples already generated at the expected necropsy's phase are moved to the indicated phase.
        <li><b>Change Status to Killed: </b> You can use this function, to mark the animal as Killed. All samples already generated at the expected necropsy's phase are moved to the indicated phase.
        </ul>
    <dt>When
    <dd><ul>
        <li><b>Phase:</b> enter a phase to remove all generated samples after this phase (the samples marked at the necropsy are always kept).
        <li><b>DateOfDeatch:</b> to update the metadata called "DateOfDeath"
        <li><b>Observation:</b> to add some comments to the biosample.
        </ul>
    <dt>Replacement
    <dd>You can replace a sample by an other from the reserve, provided you have some samples attached to study, that are not attached to a group.
    </dl>
</p>



<h3 id="study_manage">Manage / Print Samples</h3>
<h4>Sample Synchronization</h4>
<p>
    <a class="fancybox pull-xs-right" href="sc_study27.png"><img src="sc_study27.png" title="Sample Synchronization"/></a>
    When you select the <b>"Manage / Print Samples"</b> option, Spirit checks that all the samples have been created (as defined in the study's sampling template). The first time you call this option, or if the sampling's template have been modifier, Spirit shows you this dialog and asks you to synchronize the samples to match the study's design. Please check and confirm by clicking "Synchronize".<br>
    This automatic creation can be disabled, if you uncheck the box "Generate Samples automatically" in the <a href="#study_infos">study design</a>.
</p>

<h4>Manage Samples</h4>
<p>
    <a class="fancybox pull-xs-right" href="sc_study28.png"><img src="sc_study28.png" title="Manage Samples"/></a>
    This dialog shows the generated samples from the study, which you can filter by container's type, group, phase, biotype, or some keywords.
</p>

<h5>Change Ownership</h5>
<p>
    If you want to give the samples to a specific user, you can change the ownership of the samples. By default, the samples are owned by the user who created/generated them and they are editable by all the administrators of the study. By using this option, you can assign the samples to any user, who may not have rights otherwise.
</p>
<p>
    To change the ownership, select the samples, click <b>"Change Ownership"</b> and enter the username of the new owner.
</p>

<h5>Print Labels</h5>
<p>
    <a class="fancybox pull-xs-right" href="screenshot_study16.png"><img src="screenshot_study16.png" title="Print Labels"/></a>
    To print the labels, you first select the samples to print in the "Managing Samples" dialog, and then click "print labels". 
    For each type of container, the printing view shows the list of containers, and a preview of the label. The preview is rendered directly from the printers based on the entered settings (printer, media, left or right labels).
</p>

<h3 id="study_measure">Sample Measurement</h3>
<p>
    <a class="fancybox pull-xs-right" href="sc_study30.png"><img src="sc_study30.png" title="Print Labels"/></a>
    Right-clicking on the study and select "Sample Measurement" to perform the weighing or the other measurement on the generated samples, as defined in the study's sampling templates
</p>
<p>
    The experimenter can select some filter to view only the samples generated at a given phase, from a given group or he can also uncheck the "Show only samples with required measurements" to view all samples, including those without required measurements.<br>
</p>
<p>
    Each entered value is automatically saved to the database. If there a network error, the experimenter is immediately informed. Once values are entered, you can hover the mouse on the values to view who entered it and when. To enter a new value, you will be prompted for a confirmation. It is also possible to edit the samples in batch-mode and copy/paste from an Excel sheet.
</p>

<h3>Advanced</h3>
<h4>Delete Study</h4>
<p>
    To be allowed to delete a study, the user need to be an administ or the creator of the study. <br>
    If the study is deleted, it is still possible to restore through the Last Changes from the audit trail.
</p>
<h4>Change Ownership</h4>
<p>
    The owner of the study is also the creator of the study. To change it, open the study popup menu and select "Advanced"->"Change Ownership"
</p>
<h4 id="study_history">Study History</h4>
<p>
    <a class="fancybox pull-xs-right" href="sc_study33.png"><img src="sc_study33.png" title="Study History"/></a>
    Spirit contains an audit trail of all entities, including studies. To view the history of a study, open the study popup menu and select "Advanced"->"View Change History"<br>
</p>

<h1 id="biosample">Biosample</h1>
<p>
    The <b>Biosample Tab</b> shows the biosample centric view of Spirit, which should be used to query/edit biosamples
</p>
<h2 id="biosample_visualization">Visualization</h2>
<p>
    <a class="fancybox pull-xs-right" href="sc_bio1.png"><img src="sc_bio1.png" title="Biosamples Visualization"/></a>
    Once you click the Biosample Tab on Spirit, you get the biosample centric view of Spirit, with the search panel at the top-left, the detail panel at the bottom-left and the biosample table at the center.
</p>

<h3>Search Panel</h3>
<p>
    <a class="fancybox pull-xs-right" href="sc_bio2.png"><img src="sc_bio2.png" title="Biosamples Search Panel"/></a>
	In this search pane, enter the filters for making the search:
	<dl>
		<dt>StudyId:
		<dd>if a studyId is given, the filters for the groups and phases are automatically shown. It is possible to enter more than one studyId by separating them with spaces, or by selecting them in the popup menu with ctrl-click.
		<dt>Container:
		<dd>This popup contains the available container types available in the system, or used in the selected study.
		<dd>Biosample:
		<dd>
			<ul>
				<li><b>Biotype:</b> select one of the available biotype used in the selected study. If you select a biotype, the filters for each of the possible metadata are shown.
				<li><b>Keywords:</b> The keywords search will query all the related attributes of the biosample (metadata, comments, location, user, group, phase), and the attributes of all the parent biosamples.
				<p>Spirit's seach is case insensitive and ignores the special characters (.-_/:#), so that searching "Anti12" will also return the samples containing "anti#1_2"</p>
				<p>Complex queries with and/or/()/*/"" are possibles. You can click on "Exact Match" to disable the complex query behaviour and find the samples containing exactly what is entered.</p>
				<p>
				Examples:<br> 
				The query <i>Rat Dry Eyes</i> will return the biosamples having the metadata "Rat" (on the parent animal), "Dry" and "Eyes" (on the organ). <br>
				The query <i>Eyes (left or right) Box1</i> will return all left or right eyes located in a location called Box1<br>
				The query <i>"Left Lung"</i> will return the samples where one of the field is exactly "Left Lung". <br>
				The query <i>Ey*</i>	will return the biosamples having a field starting with Ey.
				</p>
				<li><b>SampleIds/ContainerIds:</b> will return the samples matching exactly the containers. It is possible to enter several ids separated by spaces.
			</ul>
		<dt>Filters</dt>
		<dd><ul>
			<li><b>Biotype: </b> shows the specific filters for the selected biotype. You can query any of the metadata, prefiltered with the possible values.
			<li><b>Location:</b> to filter the biosamples under this location and all its children location.
			<li><b>Advanced:</b> to filter based on the user, date of creation/update, the department owned by the biosample or:
				<ul>
					<li><b>Select one sample per topParent:</b> This is a useful feature if you want to retrieve one sample per human/animal based on some simple criteria
					<li><b>Only in Containers:</b>to return only the samples with a defined containerType
					<li><b>Only in Location:</b>to return only the samples with a defined location
				</ul>
			<li><b>Hide trashed/used up: </b>to return only the available samples
			</ul>
	</dl>
</p>
	
<h3>Biosample Table</h3>
<p>
    <a class="fancybox pull-xs-right" href="sc_bio3.png"><img src="sc_bio3.png" title="Biosamples Table"/></a>	
	The biosample table shows the list of biosamples matching your criteria. It is dynamically rendered according to your criteria, and the width of each column is resized to fit the data into the screen as much as possible. Smaller monitors may lead to data displayed on 2 rows or to truncated data.<br>
<p>
<p>
	The columns displayed are:
	<dl>
		<dt>Container
		<dd>The container information (containerType, containerId, Amount, Location) is shown either in 1 combined or in 4 separated columns. You can switch between the "1 column" and the "4 columns" views by either double clicking on the header, or by right-clicking the header and selecting "Container" under "Expanded Columns".
		<dt>Study
		<dd>The studyId, group and phase are displayed. The StudyId is only shown if biosamples come from different studies.
		<dt>TopId
		<dd>This column is shown only if the biosamples have a parent (not shown on the table). The topId shows the sampleId and sampleName of the top biosample in the hierarchy, together with the group's abbreviation. You can expand the column to view the related metadata by double-clicking on the headr.
		<dt>Parent
		<dd>This column is shown only if the biosamples have a parent, which is different from the topId. This column can also be expanded
		<dt>SampleId
		<dd><p>The Sample identifier (sampleId, SampleName) is shown either in 1 or 2 columns. You can switch between the "1 column" and the "2 columns" by double clicking on the header or by expanding the column on the header popup. The group of the sample and its phase is also shown for a quick overview</p>
		<p>If the sample has some children, a [+] sign is displayed next to the sampleId. You can double-click to show/hide the children. The same can be done from the header popup menu, by clicking the appropriate option under "Hierarchy"
		<dt>Metadata</dt>
		<dd>The metadata are shown either in one unstructed column (if the table contains biosamples from different biotypes) or in multiple columns, showing each metadata. By default, only the main metadata are displayed (as configured in the biotype administration), but it is possible to add other columns by opening the header popup menu. The columns to be added are the following:
			<ul>
			<li><b>Quality:</b>The quality is normally shown on the sampleId by setting a red (bad quality) to green (good quality) background on the id of this column (if any).<br>
			For exporting and sorting purpose it is possible to add the Quality column.
			<li><b>Status:</b>The quality is shown on the sampleId by setting a specific background on the icon of column.
			<li><b>Items/Children:</b>This option counts the number of children per biosample.<br>
			Those biosamples are then counted by biotype/location. This is useful to check the number of available blood/organs per animals.
			<li><b>Results:</b>This option counts or display the results linked to the biosamples.<br>
			If there is one result available, the value of this result is displayed. Otherwise, the table displays the number of tests and results per biosample.
			<li><b>Ownership Change:</b>This option shows if the biosample had a change of ownership, and to whom it was given.
			</ul>
		<dt>Owner:		
		<dd><p>This column shown the date of creation, the user who created the sample and the owned department (if any). The user who created the sample is defined as the owner.</p>
	</dl>

	<p>Sorting is possible by clicking on the table's header (depending of the selected column, you can select the type of sorting: position by row or by columns). The first sort is done in ascending order, and the second in descending order. If you need to sort on multiple columns (group, phase), you should first sort on the phase and then on the group.<br>
	The sort algorithm is case insensitive and numbers are compared as numbers when they are not mixed with the text. ie. "Box 2" comes before "Box 10", but "Box2Top" comes after "Box10Top"
</p>

<h3>Detail Panel</h3>
	<p>The detail panel shows the detailled information related to the selected biosample.
	<div class="row">
		<div class="col-xs-3">
			<a class="fancybox pull-xs-right" href="sc_bio4.png"><img src="sc_bio4.png" title="Biosample Detail 1"/></a>	
			<b>Metadata</b><br>
			This tab show the details related to the selected biosample and its parents. If some metadata were hidden from the biosample table, those would be shown here. Click on the study/location/attached files to open those links.
		</div>
		<div class="col-xs-3">
			<a class="fancybox pull-xs-right" href="sc_bio5.png"><img src="sc_bio5.png" title="Biosample Detail 2"/></a>	
			<b>History</b><br>
			This view shows the importand actions related to the biosample: sample creation, container change, treatment.
		</div>
		<div class="col-xs-3">
			<a class="fancybox pull-xs-right" href="sc_bio6.png"><img src="sc_bio6.png" title="Biosample Detail 3"/></a>	
			<b>Hierarchy</b><br>
			To view the hierarchy of the biosample, ie. all parents and children.
		</div>
		<div class="col-xs-3">
			<a class="fancybox pull-xs-right" href="sc_bio7.png"><img src="sc_bio7.png" title="Biosample Detail 4"/></a>	
			<b>Results</b><br>
			To view the results.
		</div>
	</div>


<h3>Pivot Biosamples</h3>
<p>
	<a class="fancybox pull-xs-right" href="sc_bio8.png"><img src="sc_bio8.png" title="Pivot Biosample"/></a>	
	An alternative visualization is to pivot the biosample table, to count the number of biosamples based on some criteria. The attached figure shows the number of samples, where the group is shown on the rows, and the phase, biotypes are shown on the columns.
</p>
<p>To open this view, click on "Pivot Data". Upon checking this box, Spirit displays the number of biosamples currently in your table and a new dialog opens to configure the information to be shown. In this dialog, you can then drag and drop those items at the rows/columns/cells level to start counting the biosamples based on those criteria.
</p>
<p>
Use this function to count the number of organs per animal, to count the types of plasma samples taken at different timepoint per group in a study, or to count the number of animals used per year from each provider.
<br>

<h3>Exporting Data</h3>
<p>
	<a class="fancybox pull-xs-right" href="sc_bio9.png"><img src="sc_bio9.png" title="Exporting Data"/></a>	
	On the top-right of the biosample table, you can see the three exporting options:
	<dl>
		<dt>DataWarrior
		<dd><a href="http://www.openmolecules.org/datawarrior/index.html">DataWarrior</a> is an open source visualization and analysis program, developed at Actelion and integrated in Spirit.
		<dt>CSV
		<dd>
		This option will export your table to a Comma Separated Value file, and open it with the software linked to the csv extension. This option is the best if you don't want any formatting, or if you don't have a program like Excel or Open Office, which can open the xlsx files.
		<dt>Excel
		<dd>This option will export the same table as for the csv option, with some formatting. 
	</dl>
</p>

<h2 id="biosample_editing">Editing</h2>
<p>
	<a class="fancybox pull-xs-right" href="sc_bio10.png"><img src="sc_bio10.png" title="Biosample popup menu"/></a>
	To edit, select the biosamples to be edited, right-click to open the <b>biosample popup menu</b> and select the Edit option.
</b>	
<p>
	Editing is only enabled if you have sufficient rights (the biosample's owner is shown in green in that case). To have sufficient rights, you must be either one of the study's admin or experimenters if the sample belongs to a study, be in the same department if the sample has no study or be the owner of the sample.
</p>	

<h3 id="biosample_batch">Batch Editing</h3>
<p>
	<a class="fancybox pull-xs-right" href="sc_bio11.png"><img src="sc_bio11.png" title="Biosample Batch Mode Editing"/></a>
	In batch editing, editing works like any spreadsheet (Excel). You can copy/paste from the clipboard, undo/redo your last actions.	The columns to be edited are similar to the ones described in the <a href="#biosample_visualization">biosample visualization</a>, at the exception that all columns are expanded to be easily editable. <br>
	The "batch editing" is the default dialog for the edition of living/solid/liquid samples, but it is possible to switch to the <a href="biosample_form">"Form Editing"</a> if there is only one sample to edit.
</p>
<p>
	<dl>
		<dt>Container
		<dd>There are up to 4 columns to edit the container's information, depending of the biotype configuration. The containerId is only editable after entering a containerType. For the location, you can either enter the full path like "Lab2 / Tank A / Tower 2 / Box 1 : A/04", a partial path like "Tower 2 / Box 1 : A/04", or browse the location by clicking the "Set" button. The user needs to have write access on the location. The amount column is displayed only if the biotype is set to have an amount. Those columns can be condensed in one column by double clicking the header (as shown in the <a href="#biosample_visualization">biosample visualization</a>) 
		<dt>Study
		<dd>There are up to 3 columns to edit the study's information. Those columns are shown by default for the living/solid/liquid samples, but they can be added manually (right click on the header's table to hide/show those columns if needed). The studyId/group can only be edited for the samples, whose parents are not in a study. The phase can only be edited if the parent does not have a phase. The studyId/group/phase is always inherited from the parent, and therefore cannot be changed if breaking this rule.
		<dt>ParentId
		<dd>In this column you can enter the parent of the sampleId. You need to have read access on the parent sample.
		<dt>SampleId
		<dd>You can keep the sampleId empty as it will be automatically generated, if you don't enter it. 
		<dt>Metadata
		<dd>The metadata columns depends of the biotype. Each column may show a different editor (alphanumerical, numerical, autocompletion, list, multi-list, file, link to an other sample) based on the biotype's configuration. A yellow background shows the mandatory fields. If the biosamples in the table have more than one biotype, there will be just one editable column with all the metadata, but copy/paste won't work.
	</dl>
</p>	
<p>
	To add more rows, you can simply go down with the arrow key and new rows will automatically created.
	You can also right-click on the table, select "Insert Rows" and the number of rows you wamt to insert.<br>
	It is important to know, that deleting a row from the table will not delete the sample but actually remove this biosample from the editing. If you right-click on the column, you can also sort the columns and add extra columns: ELB, quality, last update.
</p>
<p>
	
	<a class="fancybox pull-xs-right" href="sc_bio12.png"><img src="sc_bio12.png" width="250" title="Biosample Batch Mode Editing"/></a>
	Validation is done when you click the button "Save".<br>
	A red color shows erroneous fields (unknown value for a list metadata or text for a numerical value) and will give the "invalid choice" error upon saving. 
</p>
<p>
	<a class="fancybox pull-xs-right" href="sc_bio14.png"><img src="sc_bio14.png" width="450" title="Metadata correction"/></a>
	An orange color shows a warning (new entered value for an autocompletion metadata) and will lead to the "typo correction" dialog upon saving. In this dialog, each new value is checked and compared to the existing ones to suggest a replacement. In the next example: "Lung / RIGHT" should be replaced by "Lung/Right" and "Brain" is a new value with no suggestion. Click "Replace All" to accept the suggestions and leave keep the new values.
	<br>
	
	
</p>
<p>	
	<a class="fancybox " href="sc_bio13.png"><img src="sc_bio13.png" title="Biosample Set Location"/></a>
	The <b>Set Location</b> button allows the user to set the location for all the samples in a visual way, as described in the Location section. Select the samples and click or drag them to their new positions.
</p>
<p>
	It is possible at
</p>

<h3 id="biosample_form">Form Editing</h3>
<p>
	<a class="fancybox pull-xs-right" href="sc_bio15.png"><img src="sc_bio15.png" title="Biosample Form Editing"/></a>
	The "Form Editing" shows an expanded view of the sample to edit. It is the default editing mode for components (bacteria, cell line, antibody), due to the higher number of metadata for these biotypes. To switch to the <a href="biosample_batch">"Batch Mode"</a>, click on the Switch button.
</p>
<p>
	The edition in this view is very similar to the <a href="biosample_batch">"Batch mode"</a> and the same type validation applies here.
</p>

<h3 id="biosample_children">Add children/aliquots</h2>
<p>
	<a class="fancybox pull-xs-right" href="sc_bio16.png"><img src="sc_bio16.png" title="Add Children"/></a>
	To create children (aliquots) of biosamples, query and select the parent biosamples and then right-click on them to select the <b>"Add Children"</b> menu in the "New" section of the popup menu
</p>
<div class="row">
	<div class="col-xs-6">
		<a class="fancybox" href="sc_bio17.png"><img src="sc_bio17.png" title="Manual Creation"/></a>
		<b>Manual creation</b><br>
		Use this option if the children you want to create have all the same biotype.
	</div>
	<div class="col-xs-6">
		<a class="fancybox" href="sc_bio18.png"><img src="sc_bio18.png" title="Use a template"/></a>
		<b>User a sampling's tamplate</b><br>
		Use this option if the children you want to create have different biotypes or if you want to reuse a previous template. You can choose any template from a study where you have read access, or any custom you created here. 
	</div>
</div>	
<p>
	When you click the "Create Aliquots" button, you will be redirected to a new dialog to let you edit the biosamples in batch mode.<br>
	<a class="fancybox" href="sc_bio19.png"><img src="sc_bio19.png" title="Use a template"/></a>
</p>

<h3 id="biosample_results">Add results</h2>
<p>
	<a class="fancybox" href="sc_bio29.png"><img src="sc_bio29.png" title="Add Results"/></a>
	To add results to one or more biosamples, you can select them and select the option "New" and "Add Results" from the popup menu. Read more about this in the <a href="result">Result</a> section
</p>

	
<h3>Set Status</h3>
<p>
	<a class="fancybox pull-xs-right" href="sc_bio23.png"><img src="sc_bio23.png" title="Set Status"/></a>
	The status is a flag added to the sample. The status are the following:
	<ul>
	<li><b>Available: </b>default
	<li><b>Low Volume: </b>
	<li><b>Used Up: </b>
	<li><b>Trashed: </b>If you trash a biosample, it is automatically checked out from its current location.
	</ul>	
</p>
<p>
	<a class="fancybox pull-xs-right" href="sc_bio24.png"><img src="sc_bio24.png" title="SampleId Status"/></a>
	The status of the biosample can be seen visually by inspecting the sampleId. A different background on the icon is shown for each status. Yellow for low volume, pink for used up, and red for trashed.	
</p>
<p>
	<a class="fancybox pull-xs-right" href="sc_bio25.png"><img src="sc_bio25.png" title="Status Change"/></a>
	The status change can be seen in the <a href="#biosample_detail">biosample detail</a> or in the audit trail of the sample.
</p>


<h3>Set Quality</h3>
<p>
	The quality can be changed in a similar way to Bogus, Questionable, Valid (default), Confirmed.<br>
	If you set a biosample to bogus or questionable, the system will ask you to change the quality of all linked results
</p>
<p>
	<a class="fancybox pull-xs-right" href="sc_bio26.png"><img src="sc_bio26.png" title="SampleId Quality"/></a>
	The quality is shown on the sampleId. Red, orange, transparent, green are respectively used for Bogus, Questionable, Valid, Confirmed.
</p>

<h3>Set Expiry Date</h3>
<p>
	<a class="fancybox pull-xs-right" href="sc_bio27.png"><img src="sc_bio27.png" title="Set Expiry Date"/></a>
	You can add an expiry date to a set of samples. Samples with an expiry date will be displayed in the biosample table and the biosample detail.
</p>
<p>
	<a class="fancybox pull-xs-right" href="sc_bio28.png"><img src="sc_bio28.png" title="Set Expiry Date"/></a>
	To retrieve the list of expired biosamples and the list of biosamples that are going to expire. You can go to the Menu and select "Tools->Query Expired Samples". You can right-click on the samples to perform any needed operations
</p>
	
<h3>Checkin / Checkout</h3>
<p>
	<a class="fancybox pull-xs-right" href="sc_bio20.png"><img src="sc_bio20.png" title="Checkin / Checkout popup"/></a>
	To change the location of biosample, select them and open the "biosample popup menu" using right-click:
	<ul>
		<li><b>Checkin</b> is giving a new location to a biosample and <b>Relocate</b> is moving the sample to a new location
		<li><b>Checkout</b> is removing the location
	</ul>
	To set the locations, write access rights are required, and the samples should not be abstract.
</p>

<h4 id="biosample_checkin">Checkin</h4>
<p>
	<a class="fancybox" href="sc_bio21.png"><img src="sc_bio21.png" title="Checkin / Relocate"/></a>
	The selected biosamples are shown on the left panel of the checkin/relocate dialog. The destination location is shown on the right side.
	To enter a location, you can either type it by clicking on the location field and entering "Tower 2 / Box 1" or browse to the desired location. 
</p>
<p>
	To set the samples to the desired location you can:
	<ul>
		<li><b>Drag them</b> and move them to the new location. It is possible to change the location of any biosample in the box (provided you have the rights). To move several samples, use ctrl-click or shift-click to select several biosamples before dragging them
		<li><b>Double-Click</b> on the new position. The first click gives a preview of the new location, while the second click moves the samples. The way that samples are moved depends of the "direction". You can decide to assign the positions from "left to right", from "top to bottom" or to keep the same order/pattern (default) if the samples already has a position..
	</ul>
</p>
<p>
	A new location can also be created directly from this dialog.
</p>

<h4 id="biosample_checkout">Checkout</h4>
<p>
	<a class="fancybox" href="sc_bio22.png"><img src="sc_bio22.png" title="Checkout"/></a>
	To checkout biosamples, select them and click "checkout" from the popup menu. Click "Checkout" in the confirmation dialog to remove them from the location.
</p>

<h3>Advanced</h3>
<h4>Delete Batch</h4>
<p>
	Delete Batch is used when biosamples should be deleted from the database. Use this function to delete the physical sample as well as the virtual sample. After deletion, the only way to restore it is from the audit trail. Only the owner of the biosample or an admin can delete.<br>
</p>
<h4>Help Me Select Some Biosamples</h4>
<p>
	This is an advanced feature, to help you select biosamples based on some criteria. <br>
	<br>
	For example, let's say you want to make an experiment using several antibodies on different target, and you want to make sure that each antibody has a fluorophore working on a different wavelength. In this case, you should set the query criteria on the antibody's target and you should set the discriminator to the fluorophore's wavelength. Then after entering each antibody's target, Spirit will give you all the matching antibodies and let you select one antibody per target. After you select an antibody, Spirit will gray out the antibody with the same fluorophore's type (as set in the discriminating criteria).
</p>

<h4>Change Ownership</h4>
<p>
	<a class="fancybox pull-xs-right" href="sc_bio31.png"><img src="sc_bio31.png" title="Biosample history"/></a>
	It is possible to change the owner/department of a biosample through this function.
</p>
<h4>Change History</h4>
<p>
	<a class="fancybox" href="sc_bio30.png"><img src="sc_bio30.png" title="Biosample history"/></a>
	Through the change history, the user can browse the audit trail and see all changes. After clicking on a version, you can still change the tab of the biosample detail pane to visualize its hierarchy, results at this given timepoint. To restore a version, right click on the version and select "Restore"
</p>

<h1 id="location">Location</h1>
<p>
	<a class="fancybox" href="sc_loc1.png"><img src="sc_loc1.png" title="Location"/></a>
	The location Tab allows you to browse through the locations in the system, to view the organisation of the labs and to preview the content of each box.
</p>

<h2 id="location_visualization">Visualization</h2>
<h3>Search Pane</h3>
<p>
	<a class="fancybox pull-xs-right" href="sc_loc2.png"><img src="sc_loc2.png" title="Location Search Pane"/></a>
	The location search pane on the top right is where you enter the criteria for finding a location:
	<ul>
	<li>the <b>studyIds</b> to find where samples from a study are stored
	<li>the <b>biotype</b> to find all locations containing samples of this biotypes (ex: Bacteria, Antibodies)
	<li>the <b>name</b> of the location to find all locations with this name
	<li>the <b>Empty</b>/<b>NonEmpty</b> checkboxes are used to find locations without or with biosamples.
	</ul>
	Clicking <b>Search</b> will display the matches hierarchically in the <b>location table</b> and in a graphical way on the <b>location depictor</b>.
</p>
<h3>Location Table</h3>
<p>
	<a class="fancybox pull-xs-right" href="sc_loc3.png"><img src="sc_loc3.png" title="Location Table"/></a>
	The location table shows by default the root locations of types building or labs. If you make a query, the table will also display the results from the query. You can expand or collapse the content of the location by double clicking on the "+"/"-" signs.
</p>
<p>
	It is also possible to add some extra information by clicking on the header to display the <b>free</b> space available, the <b>size</b> of each box and the <b>studies</b> linked to each box.
</p>
<p>
	<a class="fancybox pull-xs-right" href="sc_loc4.png"><img src="sc_loc4.png" title="Location Table"/></a>
	Selection one location will display the location on the <b>location depictor</b>. It is also possible to select several of those locations and right-click on them to open the <b>location popup</b> to perform editing operations.
</p>
<h3>Location Browser</h3>
<p>
	<a class="fancybox pull-xs-right" href="sc_loc7.png"><img src="sc_loc7.png" title="Location Browser"/></a>
	The location browser is a component you see in many places across the applications and it is used to provide a quick access through the locations.
	It works like the explorer file of Windows: you can either click on the comboboxes to select a location or you click on the side and edit the location yourself by copy/paste:<br>
	<a class="fancybox pull-xs-right" href="sc_loc7.png"><img src="sc_loc8.png" title="Location Browser"/></a>
	You don't need to enter a full path: "Office/Lab 2/Tank A/Tower 2/Box 2" can be retrieved by typing "Tower 2/Box 2", if this location is not ambiguous
</p>
<h3>Location Depictor</h3>
<p>
	The location depictor shows the location in a graphical way. The type of display depends of the selected location.
	<div class="row">
		<div class="col-xs-6">
			<a class="fancybox" href="sc_loc5.png"><img src="sc_loc5.png" title="Location Depictor 1"/></a>
			Selection a building/lab type of location will display its children. You can click further to open the appropriate location.
		</div>
		<div class="col-xs-6">
			<a class="fancybox" href="sc_loc6.png"><img src="sc_loc6.png" title="Location Depictor 2"/></a>
			Selection a rack location will display the biosamples it contains. You can select those biosamples with the mouse or the directions key of the keyboards and pressing shift or control to select several of them.<br>
		</div>
	</div>
	Click the "CSV" or the "XLS" button to export the layout of the location.
</p>
<h2 id="location_edit">Editing</h2>
<p>
	To edit locations, you can either:
	<ul>
		<li>Select <b>New Location</b> from the edit menu or the location popup menu
		<li>Select existing locations rom the location table and select <b>Duplicate</b> from the popup menu (right-click on locations will open the popup). The hierarchy of the selected samples will be kept. This is useful to copy the layout of a tower or a tank
		<li>Select existing locations, and select "Edit Batch"
	</ul>
	If your rights are not sufficients, the options are grayed out.
</p>
<h3>Edit Table</h3>
<p>
	<a class="fancybox" href="sc_loc9.png"><img src="sc_loc9.png" title="Location - Edit"/></a>	
	The edition of locations is done through this table:
	<ul>
	<li><b>Parent: </b> The parent container, which is optional.
	<li><b>Type: </b> the type of the location:
		<ul>
			<li><b>Building</b>, <b>Lab</b>: are admin locations, that only administrators can create.
			<li><b>Freezer</b>, <b>Shelf</b>, <b>Drawer</b>, <b>Tank</b>, <b>Tower</b>: are locations that any user can create to organize its lab. They can contain children location.
			<li><b>Box</b>, <b>Rack</b>, <b>SlideBox</b>, <b>Bag</b>: are location container, which contains biosamples and have a configurable size.
		</ul>
	<li><b>Name: </b> identifier of the location. The parent/name combination must be unique.
	<li><b>Labelling: </b> If the location has a configurable size, you can configure the display of the positions: None, A1,A2,...; 1,2 (horizontal); 1,2 (vertical) 
	<li><b>Rows / Cols: </b> If the location has a configurable size, you can also specify the dimensions. Those values are optional, if the labeling is "None"
	<li><b>Privacy / Department: </b> If you run Spirit in a user-manager environment, you can setup specific rights to each location. Doing so, you can restrict the organisation of a lab to a specific department.
		<ul>
			<li><b>Inherited:</b> the default, same privacy as the parent location
			<li><b>Public:</b> the biosample's location is readable by everybody, provided you have read access on the sample.
			<li><b>Protected:</b> the biosample's location is shown as hidden to users who are not member of the specified department. This is recommended visibility for the organization of the labs.
			<li><b>Private:</b> the content of the location is completely restricted to the specified department. Biosamples inside this location are not visible/searchable to those outside the department, even if they should have access to the study/biosamples. This is the recommended visibility for backups storages.
		</ul>
	<li><b>Description: </b> The description is shown next to the name, and printed on the location's label
	</ul>
	To add new locations, you can add rows by moving down with your mouse.
</p>
<h3>Print</h3>
<p>
	<a class="fancybox" href="sc_loc10.png"><img src="sc_loc10.png" title="Location - Edit"/></a>	
	To print the label of a location, right click on them and select "Print"
</p>
<h3>Advanced</h3>
<h4>Delete Batch</h4>
<p>
	<a class="fancybox pull-xs-right" href="sc_loc12.png"><img src="sc_loc12.png" title="Location - Delete"/></a>	
	To delete a location, you must have edit rights on the location (if the location is public or if you are a member of the assigned group) and you must have edit rights on all the samples inside the location.
</p>
<p>
	If the location is not empty, Spirit will not delete the samples. A dialog will popup to ask you what to do with the samples: "Mark as Trashed" or "Mark as Used Up".
	<a class="fancybox" href="sc_loc13.png"><img src="sc_loc13.png" title="Location - Delete"/></a>	
</p>	

<h4>View Change History</h4>
<p>
	<a class="fancybox" href="sc_loc11.png"><img src="sc_loc11.png" title="Location - History"/></a>	
	All changes on the location (checking/checkout of biosamples, editing the location) is recorded. To see the changes, click on the "Advanced" > "View Change History".
</p>

<h2>Relocate / Checkout samples</h2>
<p>
	You can select biosamples directly from the biosample table or from the graphical view of the location. Right-clicking will then open the biosample popup menu, from which you can update the location.
	This feature was already explained in the <a href="#biosample_checkin">Biosample section</a>
</p>


<h1 id="result">Results</h1>
<p>
	<a class="fancybox" href="sc_res1.png"><img src="sc_res1.png" title="Results"/></a>	
	On the result's tab of Spirit, the results become the main focus of your work. There you can query, manipulate and export your data how you like. The left side of the screen is used to enter the query, and the right side is used to display and manipulate the results.<br>
</p>

<h2 id="result_visualization">Visualization</h2>
<h3 id="result_search">Search Pane</h3>
<p>
	<div class="row">
		<div class="col-xs-6">
			<a class="fancybox pull-xs-right" href="sc_res2.png"><img src="sc_res2.png" style="width:170px" title="Results"/></a>	
			The <b>result search pane</b> allows you to query by studyId, topId, keywords and tests.
			Before entering any study, Spirit shows an overview of the results already entered in Spirit. Next to each test, the number of entered results is shown in braces.
		</div>
		<div class="col-xs-6">
			<a class="fancybox pull-xs-right" href="sc_res3.png"><img src="sc_res3.png" style="width:170px" title="Results"/></a>	
			After entering one or several studyIds, Spirit shows the list of results in those studies. New filters for the biotype and the analytes become available once you select a test. 
		</div>
	</div>
</p>
<p>
	Complex queries are possible through the <b>keywords</b> search. The following operators are possible AND, OR, (, ), * and ".<br>
	Examples:
	<ul>
		<li><i>Healthy</i>: to query results on biosamples on groups containing Healthy
		<li><i>Lung</i>: to query results on biosamples on lung, lungs/left, lung/right
		<li><i>Mesoscale Fluid IL-15</i>: to query Mesoscale results on Fluid with the IL-15 analyte. <b>AND is used as the default operator</b>
		<li><i>Plasma France</i>: to query results linked to plasma from patients in France.
		<li><i>Mesoscale (Organ or Fluid)</i>: to query Mesoscale results done on organs or fluid.. <b>You can combine () and OR operators</b>
		<li><i>"Lung"</i>: to query results on biosamples on lung. <b>Quotes are used for exact matches</b>.
	</ul>
</p>
<p>
	The keywords searches all the related fields of the result: study, group, phase, topId, topName, topMetadata, parentId, parentName, parentMetadata, sampleId, sampleName, sampleMetadata, sampleBiotype, test, testInput, comments, user, electronic lab notebook, ...<br>
	The search is case-incensitive and ignore the special characters (.;/_-,#), so that searches on "IL15" will find all result on "IL 15", "IL-15", ...
</p>

<h3 id="result_table">Result Table</h3>
<p>
	After clicking search, the retrieved results are displayed on the <b>result table</b>. There are many ways to present the results and the biosample information linked to those results. Select a predefined <b>template</b> on top to choose between these views:
	<div class="row">
		<div class="col-xs-6">
			<a class="fancybox" href="sc_res4.png"><img src="sc_res4.png" title="Results Compact"/></a>	
			The <b>Compact</b> template shows all the result in a compacted form, to have a quick visualization of the type of results.<br>
			If the results are heterogeneous (several tests, done on different biotypes and different analytes), this template displays the different conditions of the test in each cell. In that case, exporting to Excel is troublesome<br>
			If the results are homogeneous (one test on different analytes), this template is similar to the <b>Column</b> template and the analytes are displayed at the columns level.
		</div>
		<div class="col-xs-6">
			<a class="fancybox" href="sc_res5.png"><img src="sc_res5.png" title="Results Column"/></a>	
			The <b>Column</b> template is the preferred template for exporting to third party analysis tools. Each column displays a different test condition.
		</div>
	</div>
	<div class="row">
		<div class="col-xs-6">
			<a class="fancybox" href="sc_res6.png"><img src="sc_res6.png" title="Results Flat"/></a>	
			The <b>Flat</b> template shows one datapoint per row. 
		</div>
		<div class="col-xs-6">
			<a class="fancybox" href="sc_res7.png"><img src="sc_res7.png" title="Results Customize Template"/></a>	
			The <b>Customize</b> button allows to configure the template to your taste
		</div>
	</div>
</p>
<p>
	
</p>

<h4 id="result_customize">Customize</h4>
<p>
	To add more information on the result table or to display this information differently, click on the <b>Customize</b> button to open the customization dialog.
</p>
<p>
	In this dialog, you can see all available items. Each is a (non-empty) piece of information linked to the result. Items like the "Location", "Animal Sex", "Plasma State" can be added to the display by dragging them with the mouse to the "Rows", "Columns" or "Cells" level. Changes to the template are shown in real time.
</p>
<p>
	<a class="fancybox" href="sc_res8.png"><img src="sc_res8.png" title="Results Customize Template"/></a>	
	In this example, we display for each Group ("GroupName", "Animal.Type", "Animal.Sex", "ELB" displayed as Row) and for each test's condition ("TestName", "Input" displayed as Columns), the average of the values, the coefficient of variation and the number of values, used for the calculation.<br>
</p>

<h4 id="result_detail">Result Detail</h4>
<p>
	<a class="fancybox " href="sc_res9.png"><img src="sc_res9.png" title="Results Detail"/></a>	
	To have more information on a calculation, click on the cell to view each datapoints linked to this calculation. 
	One of the possible use of this function, is to find outliers within a group. Displaying the coeff. of variation immediately shows if the values within a group are comparable or not, and looking at the individual datapoints points out to the possible outlier.
</p>

<h3 id="result_export">Export to DataWarrior / Excel / CSV</h3>
<p>
	<a class="fancybox pull-xs-right" href="sc_res10.png"><img src="sc_res10.png" title="Result Export"/></a>	
	Simply click Excel to export your data to Excel (xslx format), or click CSV to export it in the csv format.	
</p>
<p>
	DataWarrior is an other open-source program, which works with Spirit. It can be downloaded at <a href="http://www.openmolecules.org/datawarrior/">http://www.openmolecules.org/datawarrior/</a>. After the installation, you will be able to open the <b>dwar</b> files created by Spirit. Please read the documentation to learn more about this tool.
</p>
<p>
	<b>Export</b> will export the table, as displayed to the appropriate program.
</p>

<h3 id="result_analysis">Analysis</h2>
<p>
	<a class="fancybox pull-xs-right" href="sc_res11.png"><img src="sc_res11.png" title="Analyze"/></a>	
	To get an automated analysis of your data, click the <b>Analyze</b> button after querying your results. 
</p>
<p>
	<a class="fancybox" href="sc_res12.png"><img src="sc_res12.png" style="width:inherit" title="Analyze"/></a>	
	Each test condition (test, biotype and input) is analyzed. For each condition, Spirit calculates:
	<ul>
		<li><b>the number of groups</b>
		<li><b>the number of values</b>
		<li><b>the distribution</b>: from the distribution displayed in the histogram, Spirit assess the type of distribution: "Normal", "Log Normal" or "Uniform". A log-normal distribution will be displayed using a logarithmic scale.
		<li><b>the Kruskal-Wallis (KW) value</b>: The KW value shows how significant our test is. The lower this value is, the more significant the test is to differentiate two groups from our dataset.
	</ul>
</p>
<p>
	The different conditions are sorted by the KW value. A green background is shown when the groups are well differentiated (KW&lt;0.05) and a red background is used when groups cannot be differentiated (KW&gt;0.2)
</p>

<h4>Export to DataWarrior</h4>
<p>
	<a class="fancybox pull-xs-right" href="sc_res13.png"><img src="sc_res13.png" title="DataWarrior"/></a>	
	From the analysis dialog, click on "All" or "KW&lt;0.01" to export your data to DataWarrior for a quick visualization.
</p>
<p>	
	Based on the nature of the data, Spirit will either display:
	<ul>
	<li>a <b>Line Chart</b>: when results are phase dependant (ex: weight increase)
	<li>a <b>BoxPlot</b>: when results are not phase dependant (ex: weight of an organ)
	</ul>

	<div class="row">
		<div class="col-xs-6">
			<a class="fancybox pull-xs-right" href="sc_res14.png"><img src="sc_res14.png" title="DataWarrior"/></a>	
		</div>
		<div class="col-xs-6">
			<a class="fancybox pull-xs-right" href="sc_res15.png"><img src="sc_res15.png" title="DataWarrior"/></a>	
		</div>
	</div>
</p>	
<h4 id="result_pca">Principal Component Analysis </h4>
<p>
	You can export your data from Spirit to DataWarrior and perform a Principal Component Analysis (PCA). PCA are great to reduce the dimensions of your data and do a projection on 2 or 3 axis.
	<ul>
		<li>After retrieving the results, click the "Analyse" button.<br>
		<li>In a PCA, it is important to have a full dataset without any missing datapoints. For this purpose, the Analyze dialog highlights the biggest dataset that could be used to perform a PCA (columns in blue). To export those in DataWarrior, just click the link "PCA".
		<li>In DataWarrior, select Data->Add Principal Components: select 2 or 3 components to be calculated and select the columns on which you want to calculate the PCA
	</ul>
	<a class="fancybox pull-xs-right" href="sc_res16.gif"><img src="sc_res16.gif" title="DataWarrior PCA"/></a>	
</p>

<h4 id="result_som">Self Organizing Map</h4>
<p>
	The procedure for a Self Organizing Map (SOM) is very similar to the PCA, except that in DataWarrior, you must select Data->Self Organizing Map->Apply
	<a class="fancybox pull-xs-right" href="sc_res17.gif"><img src="sc_res17.gif" title="DataWarrior PCA"/></a>	
</p>

<h2 id="result_edit">Editing</h2>
<p>
	<a class="fancybox pull-xs-right" href="sc_res18.png"><img src="sc_res18.png" title="DataWarrior PCA"/></a>	
	To create/edit a new experiment you can:
	<ul>
		<li>Go to the menu and select "Edit -> New Results". There you will asked to enter your Electronic Lab Biological (ELB) number to define the results of your experience. The ELB defines a set of results made in one experiment and must be unique.
		<li>Go to "Edit -> New Results", and enter an existing ELB. The experiment will then be loaded and you will be able to add / update / delete results. 
		<li>Right-click on some results, and select the option Edit -> Edit ELB.
		<li>Right-click on some results and select Edit -> Edit Selected Results. This is recommended way to edit results, knowing that you cannot add or delete results in this approach
	</ul>
</p>

<p>
	<a class="fancybox pull-xs-right" href="sc_res19.png"><img src="sc_res19.png" title="Result ELB"/></a>	
	If you selected the option "New Results" from the Spirit menu, you will be prompted to enter an Biological Electronic Lab Journal number (ELB). 
</p>
<p>		
	<a class="fancybox pull-xs-right" href="sc_res20.png"><img src="sc_res20.png" title="Result ELB"/></a>	
	<dl>
		<dt>Tests
		<dd>An ELB can contain results from different tests, each test being shown in its own tab. To add an other test, click on the "+" tab. To remove the test, click the "X" of the tab.
		<dt>Result Table
		<dd><ul>
			<li>The <b>SampleId</b> is required for each result and it is sufficient to link the result to the topId (animal/human), to the study and its group. 
			<li>The <b>phase</b> is optional and can only be entered if the sample is not already associated to a phase.
			<li>The <b>attributes</b> depends of the test. For the LCMS, the analyte and the concentration are mandatory. A unit can be specified by putting into braces or brackets. ie write "IL-4 [nM]" instead of "IL-4"
			<li>The <b>comments</b>
			<li>If you right-click on the headers, it is also possible to add the ELB, the quality.
			</ul>
		<dt>Pivot
		<dd>When importing data from an other tool, the data format may differ from the format of the result table. Spirit gives the possibility to pivot the data based on the phase (ex: weight increase) or based on the test's input (ex: LCMS). T
		<div class="row">
			<div class="col-xs-6">
				<a class="fancybox pull-xs-right" href="sc_res21.png"><img src="sc_res21.png" title="Pivot per Phase"/></a>	
			</div>
			<div class="col-xs-6">
				<a class="fancybox pull-xs-right" href="sc_res22.png"><img src="sc_res22.png" title="Pivot per Input"/></a>	
			</div>
		</div>
	</dl>
</p>	
		

<h3>Advanced</h3>
	<h4>Delete Selected Results</h4>
	<p>
		Only the owner (or an admin) can delete results. To delete results, right-click on those results and select "Advanced -> Delete Selected Results" from the popup menu.
	</p>
	<h4>Change Ownership</h4>
	<p>
		In the same way, you can assign the results to someone else by right-clicking on those and selecting "Advanced -> Change Ownership"
	<p>

	<h4>Change History</h4>
	<p>
		The option is used to changes to the seected result.
	</p>




<h1 id="advanced">Advanced</h1>
<h2>Import/Export</h2>
<h2>Export</h2>
<p>
	It is possible to export Spirit data using the <b>Spirit File Format</b>. The Spirit File Format is a proprietary format which encapsulates the studies, biosamples, locations, results, biotypes and tests of the data you want to export. It is self-contained, meaning that the data exported contains everything to rebuild the exported data somewhere else (ie, if you export results, all the linked biosamples, biotypes and tests will also be exported). The file is a JSON text readable format (human readable), and it could actually by manipulated by the user or an other program.
</p>
<p>
	<a class="fancybox pull-xs-right" href="sc_adv1.png"><img src="sc_adv1.png" title="Export dlg"/></a>		
	To Export data, go to the "Edit" menu of Spirit and select "Export Data". In this dialog, you must decide what you want to export:
	<ul>
		<li><b>Export data from the current view:</b> with this option, you can make a query in any of the Spirit perspective and Spirit will export only the data needed to reconstruct the result of your query.
		<li><b>Export data from the following studies:</b>You can type the studyIds to export the study design, as well as all the associated biosamples (and their types), location, results (and their tests)
		<li><b>Export all biotypes/tests:</b>This is to export the definition of your biotypes/tests
		<li><b>Export everything:</b>This option is only possible if you have less than 10 studies, as the file may be potentially too big to export more data.		
	</ul>
	This dialog gives an overview of the data that will exported. Enter then the filename and click "Export" to export the data.
</p>
<h2>Import</h2>
<p>
	<a class="fancybox pull-xs-right" href="sc_adv2.png"><img src="sc_adv2.png" title="Import dlg"/></a>		
	To import a <b>Spirit file</b>, go to the "Edit" menu of Spirit and select "Import Data". Select a file to open the "Import Data" dialog.<br>
	The "Import Data" dialog gives you different options to import the data, in case of conflict.
	
</p>


<h0 id="admin">Administration guide</h0>
<p>
	<a class="fancybox pull-xs-right" href="sc_admin1.png"><img src="sc_admin1.png" title="Admin Popup"/></a>		
	The "Admin" menu in Spirit is only accessible by an administrator.
</p>

<h1 id="admin_database">Database Settings</h1>
<p>
	Go to the "Menu" > "Database Setting" to change the database configuration. This dialog is only visible if Spirit is started without any specific Database Adapter.
<p>
<h2 id="admin_connection">Database Connection</h2>
<p>
	<a class="fancybox pull-xs-right" href="sc_admin8.png"><img src="sc_admin8.png"  title="Recent Changes"/></a>
	In this dialog, you can configure how Spirit connects to the database. There are 3 available configurations:
	<dl>
		<dt>HSQL Local database for 1 user
		<dd>This is default configuration. With this configuration, Spirit can be tested without any other installation any other user settings. Spirit runs without any user management, and the logged in user is the administrator of the system. The HSQL database is file based, and you can specify or change the file to create/reuse an old database.
		<dt>HSQL Server database
		<dd>You can use this configuration to run Spirit in a multi-user environment. User accounts will need to be created.
			<ul>
				<li><b>Mode:</b>Server/Client. You need to setup one computer as server, and this server must always be running for the client to connect to it
				<li><b>Path (server only):</b> directory where the HSQL database should store the file (files are only stored on the server)
				<li><b>Server (client only): </b> IP address or computer name of the server to connect to
			</ul>
		<dt>Production database
		<dd>To work with productive data, you need to install a database server with proper administration and backup. Spirit works with MySQL and Oracle
			<ul>
				<li><b>Vendor: </b>MySQL / Oracle
				<li><b>Connection URL: </b>path to the database server, which is a URL like jdbc:mysql://server:3306/spirit or jdbc:oracle:thin:@server:1521:test
				<li><b>UserId: </b>the user to be used to connect to the database (spirit if you created the user through "create user spirit identified by 'PASSWORD')
				<li><b>Password: </b>You can type the Spirit encrypted password given by an administrator or you type the "..." to encrypt the connection password given to the UserId				
			</ul>
	</dl>	
</p>
<p>
	The 3 buttons below are used to initialize the database:
	<ul>
		<li><b>Test Connection:</b> to test if the user/password/dbUrl are correct. It is not possible to save if this not correct
		<li><b>Test Schema:</b> to test if the tables of the spirit schema are well created. If unsuccessfull, Spirit will propose you to update those tables to match the expected schema. The update has to be done with care, please ensure the DB is well backed up before.
		<li><b>Recreate Examples:</b> to delete the existing examples and recreate them, if the user modified them.		
	</ul>
</p>
<h2 id="admin_usersettings">User Settings</h2>
<p>
	<a class="fancybox pull-xs-right" href="sc_admin9.png"><img src="sc_admin9.png"  title="Recent Changes"/></a>
	The user settings are stored on the database and are therefore shared by all users conencting to the system. Hover your mouse on the question mark to have an explanation of each configuration item.	
</p>
<p>
	The available settings are:
	<ul>
		<li><b>Last changes:</b> the <a href="#home">Home Tab</a> shows the changes from the last N days. Use this setting to change it
		<li><b>Roles:</b> Enter a list of possible roles, that the user may have. Ex: FacilityManager, QA.
		<li><b>Login with one specific role:</b> By default, each user is logged with all its role. if this box is checked, the user needs to select its role (it becomes impossible to be an admin and a normal user at the same time)
		<li><b>Are user-rights role based only:</b> By default, the rights depends of the department. If this box is checked, the department is ignored and only the roles are used.
		<li><b>Data separation: </b>by default, Spirit under an <b>"open"</b> environment where all study designs are "viewable" and where all samples outside studies is readable by everybody. It is however possible to restrict it per department by selecting <b>"restricted"</b>: ie. only the biosamples created by the department of the logged in user are readable
	</ul>
</p>
<h2 id="admin_studysettings">Study Settings</h2>
<p>
	<a class="fancybox pull-xs-right" href="sc_admin10.png"><img src="sc_admin10.png"  title="Recent Changes"/></a>
	The study settings define the metadata of the study and the different workflow's state	
	<dl>
		<dt>Metadata
		<dd>Metadata are extra information displayed on the study's table, which can be edited in the <a href="#study_infos">Study Infos</a> dialog. Enter the list of metadata in this field. For each metadata, you can configure
		<ul>
			<li><b>Name:</b> the name shown to the end user
			<li><b>Datatype:</b> List, Alpha, Auto
			<li><b>Parameters:</b> if the datatype is list, please enter the list of possible choces
			<li><b>Roles:</b> if the edition of this field is restricted to specific roles, please enter these here. 
			<li><b>States:</b> if the edition of this field is restricted to specific workflow states, please enter these here. 
			<li><b>Required:</b> If this field is required and editable (appropriate state, user role), the user will be required to fill in this metadata
		</ul>
		<dt>States
		<dd>States are the list of possible states the study can have. It is possible to build a workflow, by restricting the promotion rights to some users and by restricing the promotion from some specific states.
		<ul>
			<li><b>From:</b> are the previous allowed states to promote. If empty, there will be no restriction
			<li><b>Promoters:</b> are the roles of the user allowed to promote. If empty, there will be no restriction
			<li><b>Read:</b> to indicate the roles of those with read access to the study in this state
			<li><b>Experimenter:</b> to indicate the roles of those with experimenter access (add biosamples, results) to the study in this state
			<li><b>Admin:</b> to indicate the roles of those with admin access (edit design, infos) to the study in this state
			<li><b>Sealed:</b> to indicate the study cannot be modified anymore in this state. All other rights are ignored
		</ul>
		It is important to not that the right's coming from the roles and those coming from the department are cumulative. 
	</dl>
		
</p>

<h1 id="admin_user">Edit User/Groups</h1>
<p>
	The menu "Admin" > "Edit User/Groups" is only active if Spirit runs under a user managed configuration.
</p>
<h2>Edit User</h2>
<p>
	<a class="fancybox pull-xs-right" href="sc_admin11.png"><img src="sc_admin11.png"  title="Edit Users"/></a>
	This dialog shows the list of user with their manager, their roles and their department. Use this interface to add a new user, delete one, edit or disactivate one.
</p>
<p>
	<a class="fancybox pull-xs-right" href="sc_admin12.png"><img src="sc_admin12.png"  title="Edit User"/></a>
	
	When adding or editing a user, you have the following options:
	<ul>
	<li><b>Username: </b> unique
	<li><b>Password: </b> Click "Reset" to suggest a password, to be given to the user. The user is then responsible to change it.
	<li><b>Manager: </b> If a manager is given, this manager will get all the read / edit rights of this user.
	<li><b>Disabled: </b> If a user becomes inactive, check this box to prevents him from logging in into this system. The same could be achieved by deleting the user.
	<li><b>Group: </b> If a group is mentioned, the biosamples created by this user will also be assigned and shared to this group.
	<li><b>Roles: </b> You can specify if this user has "admin", "readall", or any other roles specified in the <a href="#admin_database">Database Settings</a> dialog
	</ul>
	When entering a new password (by clicking the button "Reset") to a user, the user should change his password through the menu "Database" -> "Change Password"
</p>
<h2>Edit Groups</h2>
<p>
	<a class="fancybox pull-xs-right" href="sc_admin13.png"><img src="sc_admin13.png"  title="Edit User"/></a>	
	The second tab of the user administration tab is used for managing the groups.
</p>
<p>	
	It is possible to define groups in a hierarchical way: ie. Biology, Biology / Lab1, Biology / Lab2, ... This does not imply however that members of the Biology group have some access on data from Lab1 or that members of Lab1 have access on data from Biology. The hierarchy is only there for display, as each group is considered independant from the other.<br>
</p>


<h1 id="admin_biotypes">Edit Biotypes</h1>
<p>
	<a class="fancybox pull-xs-right" href="sc_admin2.png"><img src="sc_admin2.png" style="width:400px" title="Biotype overview"/></a>		
	Spirit comes preconfigured with some biotypes, which can be extended by an administrator. Click "Admin" > "Edit Biotypes" on the menu to have an overview of the biotypes.
</p>
<p>
	<a class="fancybox pull-xs-right" href="sc_admin3.png"><img src="sc_admin3.png"  title="Biotype definition"/></a>
	Clicking "Edit" or "New Biotype" brings the "biotype edition dialog"
	<dl>
	<dt>Biotype</dt>
	<dd>
	<ul>
	<li><strong>Name:</strong> must be unique
	<li><strong>Category:</strong>
	<ul>
		<li><strong>Living</strong>
		The "Human" and the "Animal" biotypes are the 2 strong representants of this category. They are essentially used to be attached to studies, and as parent of other samples
		<li><strong>Solid sample</strong>
		Non purified solid samples coming are in this category. They typically have a living sample as a parent and a weight. Examples: "Tumor", "Organ"
		<li><strong>Liquid sample</strong>
		Non purified solid samples coming are in this category. They typically have a living sample or an other non purified sample as parent and they have a volume. Examples: "Blood", "Plasma", "Serum", "Homogenate"
		<li><strong>Purified sample</strong>
		Purified samples, such as "Antibody", "Bacteria", "Primer", "Cell Definition". They don't necessarily come from a specific living sample or have a parent. They are usually not used in studies, but used to keep an inventory of available components.
		<li><strong>Library:</strong>
		Libraries consist of all abstract samples, which could be referenced by other samples. Example: "Fluorophore", referenced by "Antibody".
	</ul>
	<li><strong>Inherited from:</strong>
	Expert feature to force a given biotype to have a specific parent. Example: "Cells" inherit from "Cell Batch", which inherit themselves from "Cell Definition". It should only be used if you can say that the child biotype inherits all properties from his parent. Leave empty in all other cases.
	<li><strong>Prefix:</strong>
	The sampleId can be prefix by an prefix (letters or digits). It is optional, but recommended.<li><strong>The sampleId is editable by the user:</strong>
	Check this box if the sampleId should be editable, ie if it is meaningfull to the user. Example, the patientId or animalId should be editable by the user, whereas an organId has no meaning and should be generated
	<li><strong>Hidden</strong>
	Check this box, if you want the end-user to select this biotype. If checked, only an administrator would be able to create new samples of this type. However, existing samples are still searchable.
	</ul>
	</dd>
	<dt>Container</dt>
	<dd>
	<ul>
	<li><strong>Abstract:</strong>Check this box to prevent biosamples to have a container or a location.
	<li><strong>No ContainerId:</strong>Check this box, if the biosample can have a container and a location, but to prevent the user from entering a containerId.
	<li><strong>ContainerType:</strong>Select a containerType if you want to force all biosamples from this biotype to have a specific type of container. Example: all animals in a cage.
	<li><strong>AmountUnit:</strong>Select a unit of volume or a unit of weight if the amount of the biosamples can be measured. It is not possible to mix the units within a biotype. 
	</ul>
	</dd>
	<dt>Main Metadata:</dt>
	<dd>The main metadata is the metadata, that is always displayed. It is the field that identify the biosample the best in its context. For example, the animal No is sufficient to identify the animal in the context of a study. The organ type is sufficient to identify the organ in the context of the animal,... The main metadata is optional. Uncheck the box, if there is no field to clearly describe a biosample.
	<ul>
	<li><strong>Name:</strong> is the label used to describe this metadata
	<li><strong>Autocomplete:</strong>Check this box if you want the system to do a typo check and suggest similar entries. Check this box to avoid having an organ called "Left Lung" and an other called "Lung/Left".
	<li><strong>Required:</strong>If checked, the user will not be able to save the biosamples if the field is empty
	<li><strong>View Entered:</strong>Click there to view the options already entered by the user and to rename possible typos.
	<li><strong>Convert to Metadata:</strong>Click to convert the main metadata to a regular metadata. This change requires to update all related biosamples in the system, thus creating a new version.
	</ul>
	<dt>Other Metadata</dt>	
	<dd>Metadata are used to describe precisely each instance of the bioype. Each one is define by:
		<ul>
			<li><b>Name:</b> unique 
			<li><b>Datatype:</b> One of:
				<ul>
					<li>Numeric
					<li>Alphanumeric
					<li>Autocomplete: the system will check for typos by suggesting closely matching entries
					<li>Date / Time
					<li>File
					<li>Choice: One: the user can select one value from a predefined list, such as male / female
					<li>Choice: Multiple: the user can select several values from a predefined list. Other values from the list are also possible
					<li>Linked: Biosample: the user can select an other biosample from the specified biotype (ie: a fluorophore for an antibody)
				</ul>
			<li><b>Edit:</b> if the datatype is of type "Choice", you can edit the list of acceptable values. If the datatype is of type "Autocomplete", you can view the list of entered values and correct possible typos from the user. If the datatype is of type "Biosample", you can specify a biotype.
			<li><b>Req.:</b> check this box if the field should be required
			<li><b>Sec.:</b> check this box if the field is secundary. Secundary fields are not initially displayed on the main table but only the detail pane. It is advised to have a maximum of 6 primary metadata and to set all the long fields as secundary.
			<li><b>"+":</b>To insert/add a new metadata
			<li><b>"-":</b>To remove a metadata. This is only possible if the metadata is empty for all linked biosamples.
			<li><b>"Move..":</b>To Change the order of the metadata, or to move one as the main metadata.
		</ul>
	</dl>
	</p>
	<br>

<h1 id="admin_tests">Edit Tests</h1>
<p>
	<a class="fancybox pull-md-right" href="sc_admin4.png"><img src="sc_admin4.png" style="width:400px" title="Test overview"/></a><br>		
	Spirit comes preconfigured with some tests, which can be extended by an administrator. Click "Admin" > "Edit Test" on the menu to have an overview of the tests.<br><br>
	Click "Edit" or "New Test" to open the "test dialog":
</p>
<p style="clear:both">
	<a class="fancybox pull-md-right" href="sc_admin6.png"><img src="sc_admin6.png"  title="Test definition"/></a>	
	<dl>
		<dt>Test Name
		<dd><ul>
			<li><b>Category: </b>Tests are classified in categories for easier retrieval. It is advised to have categories such as Physiology, Proteinomics, Genomics, Histology. You can select an existing category or type a new one.
			<li><b>Name: </b>must be unique
			</ul>
		<dt>Attributes
		<dd>Attributes are split in <b>Input</b>, <b>Output</b> and <b>Info</b> attibutes. The input attributes define the protocol conditions of the tests (analyte, normalization, method), the output attributes define the outcome of the test (concentration, score), and the info attributes are extra data to be stored in Spirit but not analyzed (plate number). At least one output is required.<br>
		Each attribute is then defined as:
			<ul>
				<li><b>Name [Unit]: </b>Enter the name of the attribute and the unit in braces/brackets if needed.
				<li><b>Datatype: </b>The datatype is similar to the metadata's datatype in biosample. It is also possible to enter formula, that depends of other attributes (formula are automatically calculated when the user enters the value)
				<li><b>Req.:</b>Check this box if a value is required.
				<li><b>"+": </b> To add/insert an attribute
				<li><b>"-": </b> To remove an attribute: this is only possible if all results have an empty value for this attribute.
			</ul>
	</dl>
				

<h1 id="admin_changes">Recent Changes</h1>
<p>
	<a class="fancybox pull-xs-right" href="sc_admin7.png"><img src="sc_admin7.png"  title="Recent Changes"/></a>
	The <b>recent changed dialog</b> can be open in the Menu "Admin" > "Recent Changes". From this dialog, you can query all entity changes made into the Spirit database. All revisions linked to studies/biosamples/results/locations/biotypes/tests are recorded.  Everytime a user clicks "Save", a new revision is created.
	
</p>
<p>
	You can filter by userId, date and type of changes. Each revision shows the unique revision number, the user who did the change and when the change happened. Spirit shows the deleted entities in red, the created entities in green and the updates in orange
</p>
<p>
	There are 2 ways to restore entities from a previous revision:
	<ul>
		<li>Right-click on the revision number on the left pane and click <b>"Cancel this change"</b>: the modified entities will be reverted to the exact same state they were before this revision. ie. canceling a creation will actually delete those entities; canceling a deletion will actually recreate them.
		<li>Right-click on the entities on the center pane and click <b>"Restore this version"</b>: the entities you see will be restored to this state.
	</ul>
	To restore an entity, you will prompted for a reason, which will be stored in the comments of the restored entities, and new revision will be added.
</p>

<h0 id="developer">Developer's guide</h0>
<h1 id="erd">Entity-Relationship Diagram</h1>
    <p>
        <a class="fancybox pull-md-right" href="er.png"><img src="er.png" title="Entity-Relationship Diagram"/></a>
         Here is a simplified version of the Entity-Relationship diagram of the Spirit database. All those tables are audited, the _AUD suffix being used for the audit tables. 
    </p>
<p style="clear:both">Work in progress</p>

<h0 id="rights">Annex: User Rights</h0>
<p>
	<table>
	<tr>
		<th>Studies</th>
		<td>
			<dl>
				<dt>Edit Study Infos / Design / Attach samples
				<dd>Only the <b>administrators</b> mentioned in the <a href="#study_infos">study infos</a>, or the users with the approved admin role in the <a href="#admin_studysettings">study configuration</a>
				
				<dt>Add/Edit Biosample/Results
				<dd>Only the <b>experimenters</b> mentioned in the <a href="#study_infos">study infos</a>, or the users with the approved experimenter role in the <a href="#admin_studysettings">study configuration</a>
				
				<dt>Read Biosample/Results
				<dd>Only the <b>read-users</b> mentioned in the <a href="#study_infos">study infos</a>, or the users with the approved read-users role in the <a href="#admin_studysettings">study configuration</a>
				
				<dt>View Design
				<dd>Everybody if Spirit runs under the <a href="#admin_usersetting">"open"</a> mode, no-one otherwise. 
			</dl>
		</td>
	</tr>
	<tr>
		<th>Biosamples (not in studies)</th>
		<td>
			<dl>
				<dt>Edit
				<dd>Only the users of the same department can edit the biosample.
				<dt>Read
				<dd>Everybody if Spirit runs under the <a href="#admin_usersetting">"open"</a> mode, no-one otherwise. 
			</dl>
		</td>
	</tr>
	<tr>
		<th>Locations</th>
		<td>
			<dl>
				<dt>Edit Building/Labs</dt>
				<dd>Only an administrator can create/edit buildings
				<dt>Edit / Read</dt>
				<dd>
					<ul>
					<li> if location is public: everybody (samples are not shown if the user has no read rights on the samples)
					<li> if location is protected: everybody can search the samples but only users who are member of the given group can see the location / position
					<li> if location is private: only the users who are member of the given group
					</ul>
			</dl>
		</td>
	</tr>
	<tr>
		<th>Results</th>
		<td>
			Rights on the results are the same as for the biosamples
		</td>
	</tr>
	</table>
</p>
<p>

	The following rules also applies:<br>
	<ul>
	<li>the admin can do everything<br>
	<li>To delete a result / biosample / study, the user has to be the owner
	<li>the managers can read / edit / delete everything owned by the managed users<br>
	<li>Changing the group of a user will not affect the samples' owner. The samples stay under the former user - group (see schema below for an explanation)<br>
	</ul>
</p>
<!--
<p>
	<a class="fancybox pull-xs-right" href="annex_right1.png"><img src="annex_right1.png"  title="User Rights"/></a>
	<a class="fancybox pull-xs-right" href="annex_right2.png"><img src="annex_right2.png"  title="User Rights"/></a>
</p>

<h2>Balance Configuration</h2>
To add a balance for the Live Study Monitoring and the Sample Weighing, go to the Spirit Menu and select Config->Config(Balance). It is expected that the balance writes a tab or comma separated text file with the measured weighings.
The link to this file has to be entered in the following dialog, together with the column number containing the Weighing. <br>
<br>
Spirit works well with the Mettler Toledo balances, and the columnNo should then be the second.<br>
<br>
<table><tr><td><img src="screenshot_config1.png"/><br><i>Screenshot of the Balance Configuration</i></td></tr></table>


<h2>Printer Configuration</h2>
Printing labels is done on a Brother PTouch printer. The advised format is 12mm but Spirit can handle any width above 9mm. 9mm is the minimum to have a 2D barcode visible.
To configure the printer, first add the Brother PTouch to the control panel of windows or your OS. To be automatically detected by Spirit, the printer must contain "Brother" or "-BR" in its name.<br>
<br>
The next step is to configure the printer. Open the properties panel of the printer, and make sure you have the proper paper size selected, and the options "Half Cut" and "Chain Printing" selected, the other properties don't matter.<br>
<br>
<table><tr><td><img src="screenshot_printer1.png"/><br><i>Screenshot of Brother PTouch Settings</i></td></tr></table>
<br>
Then you have the configure the medias (paper format) to be used for each type of container. To do this, go the Advanced->Label Format settings of the Brother Printer, and import the format for each container:<br>
<br>

The following table shows for each containerType, the names of the media that are looked upon by default. First Spirit checks for the name of the Container; if it is not found Spirit checks for the preferred dimension.
The dimensions shown here are the best suited, so that the label will overlap partly and stick well at -80C.<br>
<br>
<table class=grid>
<tr><th>ContainerType</th><th>First Media</th><th>Second Media</th></tr>
<tr><td>Cryotube</td><td>Cryotube</td><td>12mmx42_1</td></tr>
<tr><td>Matrix 0.5PP</td><td>Matrix 0.5PP</td><td>12mmx33_1</td></tr>
<tr><td>Matrix 1.0PP</td><td>Matrix 1.0PP</td><td>12mmx33_1</td></tr>
<tr><td>FluidX 0.5PP</td><td>FluidX 0.5PP</td><td>12mmx33_1</td></tr>
<tr><td>FluidX 1.4PP</td><td>FluidX 1.4PP</td><td>12mmx42_1</td></tr>
<tr><td>FluidX 20ml</td><td>FluidX 20ml</td><td>12mmx62_1</td></tr>
<tr><td>Eppendorf 0.5ml</td><td>Eppendorf 0.5ml</td><td>12mmx33_1</td></tr>
<tr><td>Eppendorf 1.5ml</td><td>Eppendorf 1.5ml</td><td>12mmx42_1</td></tr>
<tr><td>Eppendorf 2.0ml</td><td>Eppendorf 2.0ml</td><td>12mmx42_1</td></tr>
<tr><td>Micronics 1.4PP</td><td>Micronics 1.4PP</td><td>12mmx33_1</td></tr>
<tr><td>Falcon 15ml</td><td>Falcon 15ml</td><td>12mmx49_1</td></tr>
<tr><td>Falcon 50ml</td><td>Falcon 50ml</td><td>12mmx62_1</td></tr>
<tr><td>Microtainer</td><td>Microtainer</td><td>12mmx42_1</td></tr>
<tr><td>Tube 5ml</td><td>Tube 5ml</td><td>12mmx49_1</td></tr>
<tr><td>Tube 9ml</td><td>Tube 9ml</td><td>12mmx49_1</td></tr>
</table>
<br>
<table><tr><td><img src="screenshot_printer2.png"/><br><i>Screenshot of Brother PTouch Media</i></td></tr></table>
<br>


<h1>Spirit Satelite applications</h1>

<h2>AnimalCare</h2>
<br>
<table><tr><td><img src="screenshot_spirit2.png"/><br><i>Animal Care - The application for handling live animal studies</i><br><br></td></tr></table>

<h2>StockCare</h2>
<br>
<table><tr><td><img src="screenshot_spirit3.png"/><br><i>StockCare - The application for managing the stock inventory</i><br><br></td></tr></table>

<h2>BioViewer</h2>
<br>
<table><tr><td><img src="screenshot_spirit4.png"/><br><i>BioViewer - The application for scanning, aliquoting</i><br><br></td></tr></table>

<h2>SlideCare</h2>
<br>
<table><tr><td><img src="screenshot_spirit5.png"/><br><i>SlideCare - The application for creating cassettes and slides</i><br><br></td></tr></table>




<h1>Installation / Configuration</h1>
<h2>Installation</h2>

Spirit is based on a model-2 client-server architecture. The server is used to host the database and the application. The client is used to run the application and it communicates directly to the database, as shown in the next schema.
The 3 major components of this system are:
<ul>
<li><b>The Database: </b> which can be MySQL or Oracle. (or any other relational database with some adaptation)
<li><b>The Webserver: </b> which is used to host the applications (Spirit and DataWarrior), so that they can be retrieved from any client
<li><b>The Client:</b> with a Java Runtime Environment installed (1.6+). It can run on Windows, Linux, MacOS
</ul>
<br>
<table><tr><td><img src="install1.png"/><br><i>Architecture</i></td></tr></table>
<br>
<h4>DB installation</h4>
The database needs the following:
<ul>
<li>a user: "spirit"
<li>a schema "spirit", which contains all biological data
<li>a schema "osiris", which contains all chemical / employee data (if applicable)
<li>the database mode should allow optimistic locking. For MySQL, it means you must use the InnoDB engine (which is the the default for versions after 5.5)
</ul>
<br>
To initialize the schemas "spirit" and "osiris", use the SQL dump files "spirit.sql" and "osiris.sql" from the installation. <br>
<br>
The user spirit must have insert / select rights on all tables of the schema; update / delete rights must also be granted on all non-audit tables (ie all tables not suffixed by _aud)
<br>

<h4>WebApp installation</h4>
To install the Spirit webapp, you need to have a webserver like Tomcat install. For this, you must install the JDK (Java Development Kit) and start the Tomcat service.<br>
<br>
To install the Spirit webapp, copy spirit.war into the webapp directory of Tomcat. The application should deploy by itself under webapp / spirit.<br>
<br>
You should still configure the starter by editing the spirit.jnlp and dw.jnlp files to providing the good url to the server.

<h4>Client installation</h4>
On the client, you must install the JRE (Java Runtime Environment) and open a webbrowser at http://{server}:8080/spirit .
If everything is well setup, you should see a webpage, with a link to start Spirit.


<h2>Configuration of Spirit</h2>
Spirit is a Java application, run as a WebStart application. It is possible to change the default behaviour of Spirit, by changing the JNLP (Java Network Launching Protocol) file used to start Spirit. Those files can be edited in the spirit.war file provided with the installation.<br>
<br>

The default JNLP file is the following:
<pre>
&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;jnlp spec="1.6+" codebase="http://localhost:8080/spirit/spirit-bin"&gt;
	&lt;information&gt;
		&lt;title&gt;Spirit&lt;/title&gt;
		&lt;vendor&gt;Actelion&lt;/vendor&gt;
		&lt;homepage href="http://www.idorsia.com"/&gt;
		&lt;description&gt;Spirit - (C) Idorsia&lt;/description&gt;
		&lt;description kind="short"&gt;Spirit&lt;/description&gt;
		&lt;icon href="ico.png"/&gt;
		&lt;icon kind="shortcut" href="ico.png"/&gt;
		&lt;icon kind="splash"  href="spirit.jpg"/&gt;
		&lt;icon kind="splash2"  href="spirit.jpg"/&gt;
		&lt;shortcut online="false"&gt;
	      &lt;desktop/&gt;
	      &lt;menu submenu="Actelion"/&gt;
	    &lt;/shortcut&gt;
	&lt;/information&gt;
	&lt;security&gt;
		&lt;all-permissions/&gt;
	&lt;/security&gt;
	&lt;resources&gt;
	&lt;j2se version="1.6+" href="http://java.sun.com/products/autodl/j2se"  java-vm-args="-Xmx1024M" /&gt;
		&lt;jar href="antlr-2.7.7.jar"/&gt;
		.....

		&lt;!-- Adapter --&gt;
		&lt;property name="jnlp.adapter" value="com.actelion.research.spirit.adapter.CustomAdapter"/&gt;
		&lt;property name="jnlp.custom.hdialect" value="org.hibernate.dialect.MySQLDialect"/&gt;
		&lt;property name="jnlp.custom.driver" value="com.mysql.jdbc.Driver"/&gt;
		&lt;property name="jnlp.custom.dburl" value="jdbc:mysql://localhost:3306/mysql"/&gt;
		&lt;property name="jnlp.custom.username" value="spirit"/&gt;
		&lt;property name="jnlp.custom.password" value="-29,-46,-70,-74,108,-14,-97,39"/&gt;
		&lt;property name="jnlp.custom.mode" value="RESTRICTED"/&gt;


	&lt;/resources&gt;
	&lt;application-desc main-class="com.actelion.research.spirit.ui.Spirit"/&gt;
&lt;/jnlp&gt;
</pre>
<br>
The important things in this file are:
<ul>
<li><b>codebase="http://localhost:8080/spirit/spirit-bin": </b> is the address of the webserver. <i>localhost:8080</i> should be replaced by the appropriate address
<li><b>java-vm-args="-Xmx1024M": </b> is the maximum amount of Memory Spirit can use. Here it means Spirit is allowed to use up to 1Go of RAM
<li><b>&lt;property name="jnlp.adapter" value="com.actelion.research.spirit.adapter.CustomAdapter"/&gt;</b> is the adapter to be used. By default, the CustomAdapter is used
</ul>

The Adapter is actually a Java class, which is injected into the program at startup. This class defines all the advanced aspect of Spirit: list of users, list of groups, user's authentification, user rights, connection to the database.

<h3>Starting Spirit with the Custom Adapter</h3>
The CustomAdapter is a simple Java class, which can be configured without writing specific code. To configure this adapter, you must edit the following lines of code:

<ul>
<li><b>&lt;property name="jnlp.adapter" value="com.actelion.research.spirit.adapter.CustomAdapter"/&gt;</b><br>
This line is mandatory to use the CustomAdapter
<li><b>&lt;property name="jnlp.custom.hdialect" value="org.hibernate.dialect.MySQLDialect"/&gt;</b><br>
This line defines the hibernate dialect to be used. For MySQL, use "org.hibernate.dialect.MySQLDialect". For Oracle 10, use "org.hibernate.dialect.Oracle10gDialect"
<li><b>&lt;property name="jnlp.custom.driver" value="com.mysql.jdbc.Driver"/&gt;</b><br>
This line defines the JDBC driver to be used.  For MySQL, use "com.mysql.jdbc.Driver". For Oracle, use "oracle.jdbc.driver.OracleDriver"
<li><b>&lt;property name="jnlp.custom.dburl" value="jdbc:mysql://localhost:3306/mysql"/&gt;</b><br>
This line defines the url (server:port) to access the database. It needs to be changed to the appropriate server in production
<li><b>&lt;property name="jnlp.custom.username" value="spirit"/&gt;</b><br>
This optional line defines the username used to access spirit (default is spirit)
<li><b>&lt;property name="jnlp.custom.password" value="653DBF45650D534F152281D5AE700BEC"/&gt;</b><br>
This line defines the password for the user spirit in an encrypted way. To avoid having the password here, you should read the section "How to write a proprietary adapter".
<li><b>&lt;property name="jnlp.custom.mode" value="RESTRICTED"/&gt;	</b><br>
This optional line defines the user right behaviour. If the value is "RESTRICTED" (default), users need to have specific READ rights, to read/view samples; in this mode, users from different labs cannot view what the other lab does. If the value is "OPEN", everybody (with login access) can view everything. See the Annex/User Rights for more infomration.
<li><b>&lt;property name="jnlp.custom.testquery" value="select 1"/&gt;	</b><br>
This optional line, defines a test query to check if the db is alive. For performance reasons, it is advised to leave this line empty to have no test query. If the connection to the db is lost, Spirit will then give an error message, but reinitialize the connection.
<li><b>&lt;property name="jnlp.custom.lastactivitydays" value="31"/&gt;	</b><br>
This optional line, defines how many days should be used for the last activity home page of Spirit (default to 31).


</ul>
<br>
The password can be changed by executing the program "java -jar updateDBpassword.jar". This program will encrypt the password to a hexadecimal encrypted string, which need to be copied to the value of jnlp.custom.password.<br>

<h3>How to start Spirit with your own SpiritAdapter</h3>
TODO

<h2>Configuration</h2>
Spirit comes already installed with some biotypes and tests, which could be used as examples. However there are some biotypes and tests, which should always be present as they are used in some part of the program:
<h3>Required Biotypes</h3>
<ul>
<li><b>Animal: </b> should be registered as a "Living" biotype, and it must have a "DateOfDeath", so that it can automatically be populated when the user changes the living's status of the animal. The option to change the living status only works for the "Animal" biotype.
<li><b>Organ: </b> the SlideCare application enables the user to cut organs and to put them on slides
<li><b>Slice: </b> the cut organs are of type "Slice", and they can have a metadata "Staining", which is automatically populated by SlideCare
</ul>

<h3>Required Tests</h3>
<ul>
<li><b>Weighing: </b> The weighing test contains no input attribute and just one output attribute containing the weight in g. It is used by the group assignment wizard and the monitoring tool to automatically register the used weight as a experiment result. The sampling weighing dialog also registers the organs's weight.
<li><b>FoodWater: </b> The FoodWater test contains no input attribute, the first output attribute with the Food (g) and the second output with the water (ml). It is used by the monitorign tool.
<li><b>FoodWater: </b> The FoodWater test contains no input attribute, the first output attribute with the Food (g) and the second output with the water (ml). It is used by the monitorign tool.
<li><b>Observation: </b> The Observation test contains one output attribute with the observation string. It is used by the monitoring tool, the sample weighing and the change living status.
<li><b>Length: </b> The length test contains one output attribute with the length in mm. It is used by the sample measurement dialog
</ul>
-->
			</div>
			<nav id="sidebar" class="sidebar col-md-3 hidden-print" role="complementary">
			</nav>
		</div>
    </div>

    <div id="footer_wrap">
       <footer class="container">
         <p class="copyright">Spirit Biobank maintained by <a href="https://github.com/jfreyss">Joel Freyss</a></p>
       </footer>
    </div>

    <script src="../js/dynamicscrollspy.min.js"></script>
    <script>
        $('#sidebar').DynamicScrollspy({
            tH: 0, //lowest-level header to be included (H2)
            bH: 4, //highest-level header to be included (H6)
            genIDs: true, //generate random IDs for headers?
        });
        $('body').scrollspy({ target: '#sidebar' })
    </script>
    <!-- Start of StatCounter Code for Default Guide -->
    <script type="text/javascript">
    var sc_project=11069810; 
    var sc_invisible=1; 
    var sc_security="18a1847b"; 
    var scJsHost = (("https:" == document.location.protocol) ?
    "https://secure." : "http://www.");
    document.write("<sc"+"ript type='text/javascript' src='" +
    scJsHost+
    "statcounter.com/counter/counter.js'></"+"script>");
    </script>
    <noscript><div class="statcounter"><a title="hit counter"
    href="http://statcounter.com/free-hit-counter/"
    target="_blank"><img class="statcounter"
    src="//c.statcounter.com/11069810/0/18a1847b/1/" alt="hit
    counter"></a></div></noscript>
    <!-- End of StatCounter Code for Default Guide -->

    </body>
</html>
